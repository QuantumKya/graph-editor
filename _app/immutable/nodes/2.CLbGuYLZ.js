import"../chunks/CWj6FrbW.js";import"../chunks/CZAPCtZx.js";import{a as Ot,l as Pt,d as ct,o as dt,r as qt,c as Lt,e as Rt}from"../chunks/D_MxPGGr.js";import{a4 as Ht,b as Bt,s as nt,h as N,M as Ft,a as Vt,A as h,ak as Ut,r as Wt,c as Gt,d as yt,f as it,j as $,Y as $t,$ as Kt,g as Mt,i as St,p as Jt,aw as ot,a2 as Et,R as vt,ax as Zt,as as jt,ay as gt,az as Qt,aA as te,N as ee,aB as re,aC as ne,aD as ie,aE as oe,Z as ae,W as se,aF as ue,aG as le,aH as fe,aI as ce,aJ as de,aK as he,u as pe,l as ye,D as Q,at as C,al as K,F as B,J,L as z,am as E,K as U,t as H,I as tt,G as j,x as Nt}from"../chunks/CrYvEmz_.js";import{b as V,i as Tt}from"../chunks/D3Q4fWwb.js";import{b as kt}from"../chunks/BQV7dE2y.js";function ve(r,n){return n}function ge(r,n,t,i){for(var o=[],s=n.length,f=0;f<s;f++)te(n[f].e,o,!0);var e=s>0&&o.length===0&&t!==null;if(e){var a=t.parentNode;ee(a),a.append(t),i.clear(),L(r,n[0].prev,n[s-1].next)}re(o,()=>{for(var c=0;c<s;c++){var u=n[c];e||(i.delete(u.k),L(r,u.prev,u.next)),ne(u.e,!e)}})}function xe(r,n,t,i,o,s=null){var f=r,e={flags:n,items:new Map,first:null};{var a=r;f=N?nt(Ft(a)):a.appendChild(Ht())}N&&Vt();var c=null,u=!1,_=Ut(()=>{var d=t();return se(d)?d:d==null?[]:Et(d)});Bt(()=>{var d=h(_),p=d.length;if(u&&p===0)return;u=p===0;let v=!1;if(N){var M=Wt(f)===Gt;M!==(p===0)&&(f=yt(),nt(f),it(!1),v=!0)}if(N){for(var A=null,y,m=0;m<p;m++){if($.nodeType===$t&&$.data===Kt){f=$,v=!0,it(!1);break}var D=d[m],k=i(D,m);y=Dt($,e,A,null,D,k,m,o,n,t),e.items.set(k,y),A=y}p>0&&nt(yt())}N||me(d,e,f,o,n,i,t),s!==null&&(p===0?c?Mt(c):c=St(()=>s(f)):c!==null&&Jt(c,()=>{c=null})),v&&it(!0),h(_)}),N&&(f=$)}function me(r,n,t,i,o,s,f){var e=r.length,a=n.items,c=n.first,u=c,_,d=null,p=[],v=[],M,A,y,m;for(m=0;m<e;m+=1){if(M=r[m],A=s(M,m),y=a.get(A),y===void 0){var D=u?u.e.nodes_start:t;d=Dt(D,n,d,d===null?n.first:d.next,M,A,m,i,o,f),a.set(A,d),p=[],v=[],u=d.next;continue}if(_e(y,M,m),(y.e.f&ot)!==0&&Mt(y.e),y!==u){if(_!==void 0&&_.has(y)){if(p.length<v.length){var k=v[0],T;d=k.prev;var Y=p[0],O=p[p.length-1];for(T=0;T<p.length;T+=1)xt(p[T],k,t);for(T=0;T<v.length;T+=1)_.delete(v[T]);L(n,Y.prev,O.next),L(n,d,Y),L(n,O,k),u=k,d=O,m-=1,p=[],v=[]}else _.delete(y),xt(y,u,t),L(n,y.prev,y.next),L(n,y,d===null?n.first:d.next),L(n,d,y),d=y;continue}for(p=[],v=[];u!==null&&u.k!==A;)(u.e.f&ot)===0&&(_??(_=new Set)).add(u),v.push(u),u=u.next;if(u===null)continue;y=u}p.push(y),d=y,u=y.next}if(u!==null||_!==void 0){for(var X=_===void 0?[]:Et(_);u!==null;)(u.e.f&ot)===0&&X.push(u),u=u.next;var F=X.length;if(F>0){var b=e===0?t:null;ge(n,X,b,a)}}vt.first=n.first&&n.first.e,vt.last=d&&d.e}function _e(r,n,t,i){Zt(r.v,n),r.i=t}function Dt(r,n,t,i,o,s,f,e,a,c){var u=(a&ie)!==0,_=(a&oe)===0,d=u?_?jt(o,!1,!1):gt(o):o,p=(a&Qt)===0?f:gt(f),v={i:p,v:d,k:s,a:null,e:null,prev:t,next:i};try{return v.e=St(()=>e(r,d,p,c),N),v.e.prev=t&&t.e,v.e.next=i&&i.e,t===null?n.first=v:(t.next=v,t.e.next=v.e),i!==null&&(i.prev=v,i.e.prev=v.e),v}finally{}}function xt(r,n,t){for(var i=r.next?r.next.e.nodes_start:t,o=n?n.e.nodes_start:t,s=r.e.nodes_start;s!==i;){var f=ae(s);o.before(s),s=f}}function L(r,n,t){n===null?r.first=t:(n.next=t,n.e.next=t&&t.e),t!==null&&(t.prev=n,t.e.prev=n&&n.e)}function Yt(r){var n,t,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var o=r.length;for(n=0;n<o;n++)r[n]&&(t=Yt(r[n]))&&(i&&(i+=" "),i+=t)}else for(t in r)r[t]&&(i&&(i+=" "),i+=t);return i}function be(){for(var r,n,t=0,i="",o=arguments.length;t<o;t++)(r=arguments[t])&&(n=Yt(r))&&(i&&(i+=" "),i+=n);return i}function we(r){return typeof r=="object"?be(r):r??""}const mt=[...` 	
\r\fÂ \v\uFEFF`];function Ae(r,n,t){var i=r==null?"":""+r;if(n&&(i=i?i+" "+n:n),t){for(var o in t)if(t[o])i=i?i+" "+o:o;else if(i.length)for(var s=o.length,f=0;(f=i.indexOf(o,f))>=0;){var e=f+s;(f===0||mt.includes(i[f-1]))&&(e===i.length||mt.includes(i[e]))?i=(f===0?"":i.substring(0,f))+i.substring(e+1):f=e}}return i===""?null:i}function _t(r,n=!1){var t=n?" !important;":";",i="";for(var o in r){var s=r[o];s!=null&&s!==""&&(i+=" "+o+": "+s+t)}return i}function Me(r,n){if(n){var t="",i,o;return Array.isArray(n)?(i=n[0],o=n[1]):i=n,i&&(t+=_t(i)),o&&(t+=_t(o,!0)),t=t.trim(),t===""?null:t}return String(r)}function R(r,n,t,i,o,s){var f=r.__className;if(N||f!==t||f===void 0){var e=Ae(t,i,s);(!N||e!==r.getAttribute("class"))&&(e==null?r.removeAttribute("class"):r.className=e),r.__className=t}else if(s&&o!==s)for(var a in s){var c=!!s[a];(o==null||c!==!!o[a])&&r.classList.toggle(a,c)}return s}function at(r,n={},t,i){for(var o in t){var s=t[o];n[o]!==s&&(t[o]==null?r.style.removeProperty(o):r.style.setProperty(o,s,i))}}function Se(r,n,t,i){var o=r.__style;if(N||o!==n){var s=Me(n,i);(!N||s!==r.getAttribute("style"))&&(s==null?r.removeAttribute("style"):r.style.cssText=s),r.__style=n}else i&&(Array.isArray(i)?(at(r,t==null?void 0:t[0],i[0]),at(r,t==null?void 0:t[1],i[1],"important")):at(r,t,i));return i}const Ee=Symbol("is custom element"),Ne=Symbol("is html");function Te(r){if(N){var n=!1,t=()=>{if(!n){if(n=!0,r.hasAttribute("value")){var i=r.value;W(r,"value",null),r.value=i}if(r.hasAttribute("checked")){var o=r.checked;W(r,"checked",null),r.checked=o}}};r.__on_r=t,ce(t),Ot()}}function W(r,n,t,i){var o=ke(r);N&&(o[n]=r.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&r.nodeName==="LINK")||o[n]!==(o[n]=t)&&(n==="loading"&&(r[ue]=t),t==null?r.removeAttribute(n):typeof t!="string"&&De(r).includes(n)?r[n]=t:r.setAttribute(n,t))}function ke(r){return r.__attributes??(r.__attributes={[Ee]:r.nodeName.includes("-"),[Ne]:r.namespaceURI===le})}var bt=new Map;function De(r){var n=bt.get(r.nodeName);if(n)return n;bt.set(r.nodeName,n=[]);for(var t,i=r,o=Element.prototype;o!==i;){t=de(i);for(var s in t)t[s].set&&n.push(s);i=fe(i)}return n}function wt(r,n,t=n){var i=he();Pt(r,"input",o=>{var s=o?r.defaultValue:r.value;if(s=st(r)?ut(s):s,t(s),i&&s!==(s=n())){var f=r.selectionStart,e=r.selectionEnd;r.value=s??"",e!==null&&(r.selectionStart=f,r.selectionEnd=Math.min(e,r.value.length))}}),(N&&r.defaultValue!==r.value||pe(n)==null&&r.value)&&t(st(r)?ut(r.value):r.value),ye(()=>{var o=n();st(r)&&o===ut(r.value)||r.type==="date"&&!o&&!r.value||o!==r.value&&(r.value=o??"")})}function st(r){var n=r.type;return n==="number"||n==="range"}function ut(r){return r===""?null:+r}const Ye=[{id:0,name:"Addition",description:"",image:"",position:[100,100]},{id:1,name:"Subtraction",description:"",image:"",position:[300,150]},{id:2,name:"Multiplication",description:"",image:"",position:[200,300]},{id:3,name:"Division",description:"",image:"",position:[300,450]}],Ie=[{from:0,to:1},{from:0,to:2},{from:2,to:3}],ft={nodes:Ye,links:Ie};var Xe=B('<img alt="Uploaded Icon" class="rounded-lg w-[300px]"/>'),ze=B('<img alt="Uploaded Icon" class="rounded-lg w-[300px]"/>'),Ce=B('<div class="flex flex-col gap-3.5 max-w-[350px] h-fit bg-neutral-950 text-white p-2.5 rounded-xl"><input type="text" placeholder="Node Title"/> <button>Upload Image</button> <input type="file" accept="image/*"/> <!> <textarea rows="6" maxlength="400" placeholder="Node Description"></textarea> <div class="relative inline-block h-fit"><button>Save</button> <button>Exit</button></div></div>');function Oe(r,n){Q(n,!0);const i=ft.nodes[n.node_id];let o=C(K(i.name)),s=C(K(i.description)),f=C(K(i.image)),e,a,c,u=!1,_=!1;dt(()=>{a.value=i.name,c.value=i.description});const d=()=>{u=!0},p="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700",v="font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none";var M=Ce(),A=J(M);Te(A),R(A,1,v),A.__change=d,V(A,b=>a=b,()=>a);var y=z(A,2);R(y,1,p),y.__click=b=>{e.click()};var m=z(y,2);m.__change=b=>{const I=b.target;if(!I.files||I.files.length===0)return;const G=I.files[0],S=new FileReader;S.onload=()=>{typeof S.result=="string"&&E(f,S.result,!0)},S.readAsDataURL(G),d()},Se(m,"",{},{display:"none"}),V(m,b=>e=b,()=>e);var D=z(m,2);{var k=b=>{var I=Xe();j(()=>W(I,"src",h(f))),H(b,I)},T=b=>{var I=ze();j(()=>W(I,"src",`${kt??""}/landscape-placeholder.svg`)),H(b,I)};Tt(D,b=>{h(f)!=""?b(k):b(T,!1)})}var Y=z(D,2);qt(Y),R(Y,1,"font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none placeholder:text-neutral-400 resize-none overflow-scroll"),Y.__change=d,V(Y,b=>c=b,()=>c);var O=z(Y,2),X=J(O);R(X,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-left"),X.__click=()=>{_=n.saveNode(n.node_id,h(o),h(s),h(f))};var F=z(X,2);R(F,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-right"),F.__click=()=>n.exitNode(_,u),U(O),U(M),wt(A,()=>h(o),b=>E(o,b)),wt(Y,()=>h(s),b=>E(s,b)),H(r,M),tt()}ct(["change","click"]);var Pe=B("<button><img/></button>"),qe=B('<div class="flex absolute rounded-xl bg-neutral-200 border-blue-300 border-2 p-[15px] pt-[5px] pb-[5px] h-fit bottom-6 left-[50%] transform -translate-[50%]"></div>');function Le(r,n){Q(n,!0);let t=C(2),i=["node_add.png","node_edit.png","node_drag.png","link.png"];const o=Lt();Nt(()=>{o("modeChanged",h(t))});var s=qe();xe(s,21,()=>i,ve,(f,e,a)=>{var c=Pe();c.__click=()=>E(t,a,!0);var u=J(c);U(c),j(_=>{R(c,1,`p-2.5 rounded-xl border-none outline-none transition duration-200 hover:bg-blue-300 ${h(t)===a?"bg-gray-500 mt-auto mb-auto":"mt-[10px] mb-[10px]"}`),W(u,"src",`${kt??""}/mode_icons/${h(e)??""}`),W(u,"alt",_),R(u,1,we(h(t)===a?"max-w-[40px] rounded-xl":"max-w-[30px] rounded-lg"))},[()=>i[h(t)].split(".")[0]]),H(f,c)}),U(s),H(r,s),tt()}ct(["click"]);function Re(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lt={exports:{}},At;function He(){return At||(At=1,function(r,n){r.exports=t;function t(e,a){if(!(this instanceof t))return new t(e,a);this.x=e||0,this.y=a||0}t.fromArray=function(e){return new t(e[0]||0,e[1]||0)},t.fromObject=function(e){return new t(e.x||0,e.y||0)},t.prototype.addX=function(e){return this.x+=e.x,this},t.prototype.addY=function(e){return this.y+=e.y,this},t.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},t.prototype.addScalar=function(e){return this.x+=e,this.y+=e,this},t.prototype.addScalarX=function(e){return this.x+=e,this},t.prototype.addScalarY=function(e){return this.y+=e,this},t.prototype.subtractX=function(e){return this.x-=e.x,this},t.prototype.subtractY=function(e){return this.y-=e.y,this},t.prototype.subtract=function(e){return this.x-=e.x,this.y-=e.y,this},t.prototype.subtractScalar=function(e){return this.x-=e,this.y-=e,this},t.prototype.subtractScalarX=function(e){return this.x-=e,this},t.prototype.subtractScalarY=function(e){return this.y-=e,this},t.prototype.divideX=function(e){return this.x/=e.x,this},t.prototype.divideY=function(e){return this.y/=e.y,this},t.prototype.divide=function(e){return this.x/=e.x,this.y/=e.y,this},t.prototype.divideScalar=function(e){return e!==0?(this.x/=e,this.y/=e):(this.x=0,this.y=0),this},t.prototype.divideScalarX=function(e){return e!==0?this.x/=e:this.x=0,this},t.prototype.divideScalarY=function(e){return e!==0?this.y/=e:this.y=0,this},t.prototype.invertX=function(){return this.x*=-1,this},t.prototype.invertY=function(){return this.y*=-1,this},t.prototype.invert=function(){return this.invertX(),this.invertY(),this},t.prototype.multiplyX=function(e){return this.x*=e.x,this},t.prototype.multiplyY=function(e){return this.y*=e.y,this},t.prototype.multiply=function(e){return this.x*=e.x,this.y*=e.y,this},t.prototype.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},t.prototype.multiplyScalarX=function(e){return this.x*=e,this},t.prototype.multiplyScalarY=function(e){return this.y*=e,this},t.prototype.normalize=function(){var e=this.length();return e===0?(this.x=1,this.y=0):this.divide(t(e,e)),this},t.prototype.norm=t.prototype.normalize,t.prototype.limit=function(e,a){return Math.abs(this.x)>e&&(this.x*=a),Math.abs(this.y)>e&&(this.y*=a),this},t.prototype.randomize=function(e,a){return this.randomizeX(e,a),this.randomizeY(e,a),this},t.prototype.randomizeX=function(e,a){var c=Math.min(e.x,a.x),u=Math.max(e.x,a.x);return this.x=o(c,u),this},t.prototype.randomizeY=function(e,a){var c=Math.min(e.y,a.y),u=Math.max(e.y,a.y);return this.y=o(c,u),this},t.prototype.randomizeAny=function(e,a){return Math.round(Math.random())?this.randomizeX(e,a):this.randomizeY(e,a),this},t.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.toFixed=function(e){return typeof e>"u"&&(e=8),this.x=this.x.toFixed(e),this.y=this.y.toFixed(e),this},t.prototype.mixX=function(e,a){return typeof a>"u"&&(a=.5),this.x=(1-a)*this.x+a*e.x,this},t.prototype.mixY=function(e,a){return typeof a>"u"&&(a=.5),this.y=(1-a)*this.y+a*e.y,this},t.prototype.mix=function(e,a){return this.mixX(e,a),this.mixY(e,a),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyX=function(e){return this.x=e.x,this},t.prototype.copyY=function(e){return this.y=e.y,this},t.prototype.copy=function(e){return this.copyX(e),this.copyY(e),this},t.prototype.zero=function(){return this.x=this.y=0,this},t.prototype.dot=function(e){return this.x*e.x+this.y*e.y},t.prototype.cross=function(e){return this.x*e.y-this.y*e.x},t.prototype.projectOnto=function(e){var a=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=a*e.x,this.y=a*e.y,this},t.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},t.prototype.horizontalAngleDeg=function(){return s(this.horizontalAngle())},t.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},t.prototype.verticalAngleDeg=function(){return s(this.verticalAngle())},t.prototype.angle=t.prototype.horizontalAngle,t.prototype.angleDeg=t.prototype.horizontalAngleDeg,t.prototype.direction=t.prototype.horizontalAngle,t.prototype.rotate=function(e){var a=this.x*Math.cos(e)-this.y*Math.sin(e),c=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=a,this.y=c,this},t.prototype.rotateDeg=function(e){return e=f(e),this.rotate(e)},t.prototype.rotateTo=function(e){return this.rotate(e-this.angle())},t.prototype.rotateToDeg=function(e){return e=f(e),this.rotateTo(e)},t.prototype.rotateBy=function(e){var a=this.angle()+e;return this.rotate(a)},t.prototype.rotateByDeg=function(e){return e=f(e),this.rotateBy(e)},t.prototype.distanceX=function(e){return this.x-e.x},t.prototype.absDistanceX=function(e){return Math.abs(this.distanceX(e))},t.prototype.distanceY=function(e){return this.y-e.y},t.prototype.absDistanceY=function(e){return Math.abs(this.distanceY(e))},t.prototype.distance=function(e){return Math.sqrt(this.distanceSq(e))},t.prototype.distanceSq=function(e){var a=this.distanceX(e),c=this.distanceY(e);return a*a+c*c},t.prototype.length=function(){return Math.sqrt(this.lengthSq())},t.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},t.prototype.magnitude=t.prototype.length,t.prototype.isZero=function(){return this.x===0&&this.y===0},t.prototype.isEqualTo=function(e){return this.x===e.x&&this.y===e.y},t.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},t.prototype.toArray=function(){return[this.x,this.y]},t.prototype.toObject=function(){return{x:this.x,y:this.y}};var i=180/Math.PI;function o(e,a){return Math.floor(Math.random()*(a-e+1)+e)}function s(e){return e*i}function f(e){return e/i}}(lt)),lt.exports}var Be=He();const q=Re(Be);var Fe=B(`<textarea class="resize-none absolute h-[200px] max-w-[500px] max-h-[450px] rounded-xl overflow-y-scroll text-wrap font-mono text-blue-300 bg-gray-700 bottom-1 left-1" readonly="" cols="48">
</textarea>`);function Ve(r,n){Q(n,!0);let t=K([]),i;const o=f=>t.push(f);Nt(()=>{i.value+=`
`+t.at(-1)}),dt(()=>{i.value="",o(` ------------------ Edit Log ------------------ 
`)});var s=Fe();return V(s,f=>i=f,()=>i),H(r,s),tt({log:o})}const Ue=(r,n,t,i)=>{h(n)||(E(t,!1),E(i,!1))},We=(r,n)=>{r.key=="Escape"&&h(n)&&E(n,!1)};var Ge=r=>r.preventDefault(),$e=B('<div id="canvas-box" class="relative inline-block overflow-hidden"><canvas></canvas> <div class="absolute right-2.5 top-2.5"><!></div> <!> <!></div>');function Ke(r,n){Q(n,!0);let t,i=new q(0,0),o=1,s=C(!1),f,e,a,c=new q(0,0),u=ft.nodes,_=ft.links,d,p=C(K(u[0])),v=C(!1),M=C(!1),A,y=C(!1),m=0,D;const k=()=>{d=u.map(g=>{let x=new Image;return x.src=g.image,x});const l=t.getContext("2d");if(l===null)throw new Error("DRAW LOOP - ctx is null");t.width=window.innerWidth,t.height=window.innerHeight,l.clearRect(0,0,t.width,t.height),h(y)&&(l.beginPath(),l.moveTo(h(p).position[0]-i.x,h(p).position[1]-i.y),l.lineTo(a.x,a.y),l.lineWidth=10,l.strokeStyle="rgba(0, 0, 0, 0.35)",l.stroke()),_.forEach(g=>{l.beginPath();const x=u[g.from],w=u[g.to];l.moveTo(x.position[0]-i.x,x.position[1]-i.y),l.lineTo(w.position[0]-i.x,w.position[1]-i.y),l.lineWidth=10,l.strokeStyle="black",l.stroke()}),u.forEach((g,x)=>{d[x].src=g.image;const w=q.fromArray(g.position).subtract(i),P=25;l.beginPath(),l.arc(w.x,w.y,20,0,Math.PI*2),l.fillStyle="black",l.fill(),l.drawImage(d[x],w.x-P/2,w.y-P/2,P,P)}),requestAnimationFrame(k)},T=l=>{const g=t.getBoundingClientRect(),x=(l.clientX-g.left+i.x)/o,w=(l.clientY-g.top+i.y)/o;return new q(x,w)},Y=(l,g,x)=>{const w=g.clone().subtract(l),Z=x.clone().subtract(l).dot(w)/w.lengthSq();if(Z<0||Z>1)return 1e6;const rt=Math.abs(g.clone().subtract(l).cross(x.clone().subtract(l))),Ct=g.clone().subtract(l).length();return rt/Ct},O=l=>{if(h(M))return;const g=T(l);let x=u.find(w=>q.fromArray(w.position).distanceSq(g)<400);if(E(p,x??h(p),!0),l.button===0){if(m===1){if(!x)return;E(M,!0)}else if(m===2){if(!x)return;c=g.clone().subtract(q.fromArray(h(p).position)),E(v,!0)}else if(m===3)if(x)if(h(y)){if(A.id===h(p).id)return;_.push({from:A.id,to:h(p).id}),E(y,!1),D.log(`New link created:
	node ${A.id} -> ${h(p).id}`)}else A=x,E(y,!0),a=g;else{const w=_.findIndex(P=>{const Z=u[P.from],rt=u[P.to];return Y(q.fromArray(Z.position),q.fromArray(rt.position),g)<10});w!==-1&&_.splice(w,1)}}l.button===2&&(E(s,!0),f=g,e=i)},X=l=>{if(h(M))return;const g=T(l);if(a=g,h(v)){let x=u.find(w=>w.id===h(p).id);if(x===void 0)throw new Error("uhhh focusNode error, it's not in the list...");x.position=g.clone().subtract(c).toArray()}else if(h(s)){const x=g.clone().subtract(f);i=e.clone().subtract(x)}},F=l=>{l.preventDefault()},b=(l,g,x,w)=>window.confirm("Save this node with new contents?")?(u[l].name=g,u[l].description=x,u[l].image=w,!0):!1,I=(l,g)=>{!l&&g&&!window.confirm("Stop editing without saving?")||E(M,!1)};dt(k);var G=$e(),S=J(G);let ht;S.__mousemove=X,S.__mousedown=O,S.__mouseup=[Ue,M,v,s],S.__keydown=[We,y],S.__contextmenu=[Ge],V(S,l=>t=l,()=>t);var et=z(S,2),It=J(et);{var Xt=l=>{Oe(l,{get node_id(){return h(p).id},saveNode:b,exitNode:I})};Tt(It,l=>{h(M)&&l(Xt)})}U(et);var pt=z(et,2);V(Ve(pt,{}),l=>D=l,()=>D);var zt=z(pt,2);Le(zt,{$$events:{modeChanged:l=>m=l.detail}}),U(G),j(l=>ht=R(S,1,"bg-neutral-100",null,ht,l),[()=>({"cursor-grabbing":h(v)||h(s)})]),Rt("wheel",S,F),H(r,G),tt()}ct(["mousemove","mousedown","mouseup","keydown","contextmenu"]);function rr(r){Ke(r,{})}export{rr as component};
