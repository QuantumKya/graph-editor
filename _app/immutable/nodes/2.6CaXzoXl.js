import"../chunks/CWj6FrbW.js";import"../chunks/68dL1qPk.js";import{X as _e,b as we,ax as ee,s as _t,h as U,M as ke,a as Ae,A as s,al as Me,r as Se,c as Ee,d as jt,f as wt,j as it,Z as Ne,a1 as De,g as ne,i as re,p as Le,ay as kt,a4 as oe,q as Ce,R as Bt,az as Ct,aA as Ft,aB as Tt,at as Te,aC as Gt,aD as Ie,aE as Oe,N as Ye,aF as Xe,aG as ze,aH as Pe,_ as Re,W as qe,aI as Ue,aJ as He,aK as je,aL as Be,aM as Fe,aN as Ge,u as Ve,l as We,D as rt,au as P,am as Q,F as z,J as X,L as N,an as E,K as O,t as Y,I as ot,G as $,x as ie,m as Je,n as Ze,aO as Vt,av as Wt,aP as Jt,aQ as Ke}from"../chunks/DJWGDQ8C.js";import{a as Qe,l as $e,d as tt,o as vt,r as tn,s as at,e as en,b as nn}from"../chunks/DoBE4cx5.js";import{b as B,i as et}from"../chunks/D6yf63is.js";import{b as ae}from"../chunks/B8_5t7wu.js";function Nt(n,r){return r}function rn(n,r,e,o){for(var a=[],u=r.length,f=0;f<u;f++)Oe(r[f].e,a,!0);var t=u>0&&a.length===0&&e!==null;if(t){var c=e.parentNode;Ye(c),c.append(e),o.clear(),J(n,r[0].prev,r[u-1].next)}Xe(a,()=>{for(var m=0;m<u;m++){var k=r[m];t||(o.delete(k.k),J(n,k.prev,k.next)),ze(k.e,!t)}})}function Dt(n,r,e,o,a,u=null){var f=n,t={flags:r,items:new Map,first:null},c=(r&ee)!==0;if(c){var m=n;f=U?_t(ke(m)):m.appendChild(_e())}U&&Ae();var k=null,S=!1,p=Me(()=>{var _=e();return qe(_)?_:_==null?[]:oe(_)});we(()=>{var _=s(p),l=_.length;if(S&&l===0)return;S=l===0;let A=!1;if(U){var y=Se(f)===Ee;y!==(l===0)&&(f=jt(),_t(f),wt(!1),A=!0)}if(U){for(var h=null,v,M=0;M<l;M++){if(it.nodeType===Ne&&it.data===De){f=it,A=!0,wt(!1);break}var b=_[M],g=o(b,M);v=se(it,t,h,null,b,g,M,a,r,e),t.items.set(g,v),h=v}l>0&&_t(jt())}U||on(_,t,f,a,r,o,e),u!==null&&(l===0?k?ne(k):k=re(()=>u(f)):k!==null&&Le(k,()=>{k=null})),A&&wt(!0),s(p)}),U&&(f=it)}function on(n,r,e,o,a,u,f){var lt,ut,ct,dt;var t=(a&Ie)!==0,c=(a&(Ct|Tt))!==0,m=n.length,k=r.items,S=r.first,p=S,_,l=null,A,y=[],h=[],v,M,b,g;if(t)for(g=0;g<m;g+=1)v=n[g],M=u(v,g),b=k.get(M),b!==void 0&&((lt=b.a)==null||lt.measure(),(A??(A=new Set)).add(b));for(g=0;g<m;g+=1){if(v=n[g],M=u(v,g),b=k.get(M),b===void 0){var T=p?p.e.nodes_start:e;l=se(T,r,l,l===null?r.first:l.next,v,M,g,o,a,f),k.set(M,l),y=[],h=[],p=l.next;continue}if(c&&an(b,v,g,a),(b.e.f&kt)!==0&&(ne(b.e),t&&((ut=b.a)==null||ut.unfix(),(A??(A=new Set)).delete(b))),b!==p){if(_!==void 0&&_.has(b)){if(y.length<h.length){var I=h[0],D;l=I.prev;var q=y[0],R=y[y.length-1];for(D=0;D<y.length;D+=1)Zt(y[D],I,e);for(D=0;D<h.length;D+=1)_.delete(h[D]);J(r,q.prev,R.next),J(r,l,q),J(r,R,I),p=I,l=R,g-=1,y=[],h=[]}else _.delete(b),Zt(b,p,e),J(r,b.prev,b.next),J(r,b,l===null?r.first:l.next),J(r,l,b),l=b;continue}for(y=[],h=[];p!==null&&p.k!==M;)(p.e.f&kt)===0&&(_??(_=new Set)).add(p),h.push(p),p=p.next;if(p===null)continue;b=p}y.push(b),l=b,p=b.next}if(p!==null||_!==void 0){for(var W=_===void 0?[]:oe(_);p!==null;)(p.e.f&kt)===0&&W.push(p),p=p.next;var Z=W.length;if(Z>0){var st=(a&ee)!==0&&m===0?e:null;if(t){for(g=0;g<Z;g+=1)(ct=W[g].a)==null||ct.measure();for(g=0;g<Z;g+=1)(dt=W[g].a)==null||dt.fix()}rn(r,W,st,k)}}t&&Ce(()=>{var ft;if(A!==void 0)for(b of A)(ft=b.a)==null||ft.apply()}),Bt.first=r.first&&r.first.e,Bt.last=l&&l.e}function an(n,r,e,o){(o&Ct)!==0&&Ft(n.v,r),(o&Tt)!==0?Ft(n.i,e):n.i=e}function se(n,r,e,o,a,u,f,t,c,m){var k=(c&Ct)!==0,S=(c&Pe)===0,p=k?S?Te(a,!1,!1):Gt(a):a,_=(c&Tt)===0?f:Gt(f),l={i:_,v:p,k:u,a:null,e:null,prev:e,next:o};try{return l.e=re(()=>t(n,p,_,m),U),l.e.prev=e&&e.e,l.e.next=o&&o.e,e===null?r.first=l:(e.next=l,e.e.next=l.e),o!==null&&(o.prev=l,o.e.prev=l.e),l}finally{}}function Zt(n,r,e){for(var o=n.next?n.next.e.nodes_start:e,a=r?r.e.nodes_start:e,u=n.e.nodes_start;u!==o;){var f=Re(u);a.before(u),u=f}}function J(n,r,e){r===null?n.first=e:(r.next=e,r.e.next=e&&e.e),e!==null&&(e.prev=r,e.e.prev=r&&r.e)}function le(n){var r,e,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n)){var a=n.length;for(r=0;r<a;r++)n[r]&&(e=le(n[r]))&&(o&&(o+=" "),o+=e)}else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function sn(){for(var n,r,e=0,o="",a=arguments.length;e<a;e++)(n=arguments[e])&&(r=le(n))&&(o&&(o+=" "),o+=r);return o}function ln(n){return typeof n=="object"?sn(n):n??""}const Kt=[...` 	
\r\fÂ \v\uFEFF`];function un(n,r,e){var o=n==null?"":""+n;if(r&&(o=o?o+" "+r:r),e){for(var a in e)if(e[a])o=o?o+" "+a:a;else if(o.length)for(var u=a.length,f=0;(f=o.indexOf(a,f))>=0;){var t=f+u;(f===0||Kt.includes(o[f-1]))&&(t===o.length||Kt.includes(o[t]))?o=(f===0?"":o.substring(0,f))+o.substring(t+1):f=t}}return o===""?null:o}function Qt(n,r=!1){var e=r?" !important;":";",o="";for(var a in n){var u=n[a];u!=null&&u!==""&&(o+=" "+a+": "+u+e)}return o}function cn(n,r){if(r){var e="",o,a;return Array.isArray(r)?(o=r[0],a=r[1]):o=r,o&&(e+=Qt(o)),a&&(e+=Qt(a,!0)),e=e.trim(),e===""?null:e}return String(n)}function j(n,r,e,o,a,u){var f=n.__className;if(U||f!==e||f===void 0){var t=un(e,o,u);(!U||t!==n.getAttribute("class"))&&(t==null?n.removeAttribute("class"):n.className=t),n.__className=e}else if(u&&a!==u)for(var c in u){var m=!!u[c];(a==null||m!==!!a[c])&&n.classList.toggle(c,m)}return u}function At(n,r={},e,o){for(var a in e){var u=e[a];r[a]!==u&&(e[a]==null?n.style.removeProperty(a):n.style.setProperty(a,u,o))}}function ue(n,r,e,o){var a=n.__style;if(U||a!==r){var u=cn(r,o);(!U||u!==n.getAttribute("style"))&&(u==null?n.removeAttribute("style"):n.style.cssText=u),n.__style=r}else o&&(Array.isArray(o)?(At(n,e==null?void 0:e[0],o[0]),At(n,e==null?void 0:e[1],o[1],"important")):At(n,e,o));return o}const dn=Symbol("is custom element"),fn=Symbol("is html");function ce(n){if(U){var r=!1,e=()=>{if(!r){if(r=!0,n.hasAttribute("value")){var o=n.value;nt(n,"value",null),n.value=o}if(n.hasAttribute("checked")){var a=n.checked;nt(n,"checked",null),n.checked=a}}};n.__on_r=e,Be(e),Qe()}}function nt(n,r,e,o){var a=hn(n);U&&(a[r]=n.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&n.nodeName==="LINK")||a[r]!==(a[r]=e)&&(r==="loading"&&(n[Ue]=e),e==null?n.removeAttribute(r):typeof e!="string"&&pn(n).includes(r)?n[r]=e:n.setAttribute(r,e))}function hn(n){return n.__attributes??(n.__attributes={[dn]:n.nodeName.includes("-"),[fn]:n.namespaceURI===He})}var $t=new Map;function pn(n){var r=$t.get(n.nodeName);if(r)return r;$t.set(n.nodeName,r=[]);for(var e,o=n,a=Element.prototype;a!==o;){e=Fe(o);for(var u in e)e[u].set&&r.push(u);o=je(o)}return r}function Lt(n,r,e=r){var o=Ge();$e(n,"input",a=>{var u=a?n.defaultValue:n.value;if(u=Mt(n)?St(u):u,e(u),o&&u!==(u=r())){var f=n.selectionStart,t=n.selectionEnd;n.value=u??"",t!==null&&(n.selectionStart=f,n.selectionEnd=Math.min(t,n.value.length))}}),(U&&n.defaultValue!==n.value||Ve(r)==null&&n.value)&&e(Mt(n)?St(n.value):n.value),We(()=>{var a=r();Mt(n)&&a===St(n.value)||n.type==="date"&&!a&&!n.value||a!==n.value&&(n.value=a??"")})}function Mt(n){var r=n.type;return r==="number"||r==="range"}function St(n){return n===""?null:+n}var vn=z('<img alt="Uploaded Icon" class="rounded-lg w-[150px]"/>'),gn=z('<img alt="Uploaded Icon" class="rounded-lg w-[150px]"/>'),yn=z('<div class="flex flex-col gap-3.5 max-w-[350px] h-fit bg-neutral-950 text-white p-2.5 rounded-xl"><input type="text" placeholder="Node Title"/> <!> <button>Upload Image</button> <input type="file" accept="image/*"/> <div class="relative inline-block h-fit"><button>Save</button> <button>Exit</button></div></div>');function xn(n,r){rt(r,!0);let e=P(Q(r.node.name)),o=P(Q(r.node.image)),a,u,f=!1,t=!1;vt(()=>{u.value=r.node.name});const c=()=>{f=!0},m="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700",k="font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none";var S=yn(),p=X(S);ce(p),j(p,1,k),p.__change=c,B(p,g=>u=g,()=>u);var _=N(p,2);{var l=g=>{var T=vn();$(()=>nt(T,"src",s(o))),Y(g,T)},A=g=>{var T=gn();$(()=>nt(T,"src",`${ae??""}/landscape-placeholder.svg`)),Y(g,T)};et(_,g=>{s(o)!=""?g(l):g(A,!1)})}var y=N(_,2);j(y,1,m),y.__click=g=>{a.click()};var h=N(y,2);h.__change=g=>{const T=g.target;if(!T.files||T.files.length===0)return;const I=T.files[0],D=new FileReader;D.onload=()=>{typeof D.result=="string"&&E(o,D.result,!0)},D.readAsDataURL(I),c()},ue(h,"",{},{display:"none"}),B(h,g=>a=g,()=>a);var v=N(h,2),M=X(v);j(M,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-left"),M.__click=()=>{t=r.saveNode(r.node,s(e),s(o))};var b=N(M,2);j(b,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-right"),b.__click=()=>r.exitNode(t,f),O(v),O(S),Lt(p,()=>s(e),g=>E(e,g)),Y(n,S),ot()}tt(["change","click"]);var bn=z('<div class="w-[5px] bg-neutral-300 rounded-full m-3"></div>'),mn=z("<button><img/></button>"),_n=z('<div class="flex absolute rounded-xl bg-neutral-200 border-blue-300 border-2 p-[10px] pt-[5px] pb-[5px] h-fit bottom-6 left-[50%] transform -translate-[50%]"></div>');function wn(n,r){rt(r,!0);let e=P(2),o=["node_add.png","node_edit.png","node_drag.png","","link_add.png","link_edit.png"];ie(()=>{r.modeChanged(s(e))});var a=_n();Dt(a,21,()=>o,Nt,(u,f,t)=>{var c=Je(),m=Ze(c);{var k=p=>{var _=bn();Y(p,_)},S=p=>{var _=mn();_.__click=()=>E(e,t-o.slice(0,t).filter(A=>A==="").length);var l=X(_);O(_),$((A,y,h)=>{j(_,1,`p-2.5 rounded-xl border-none outline-none transition duration-200 hover:bg-blue-300 ${A??""}`),nt(l,"src",`${ae??""}/mode_icons/${s(f)??""}`),nt(l,"alt",y),j(l,1,h)},[()=>s(e)===t-o.slice(0,t).filter(A=>A==="").length?"bg-gray-500 mt-auto mb-auto":"mt-[10px] mb-[10px]",()=>o[t].split(".")[0],()=>ln(s(e)===t-o.slice(0,t).filter(A=>A==="").length?"max-w-[40px] rounded-xl":"max-w-[30px] rounded-lg")]),Y(p,_)};et(m,p=>{s(f)===""?p(k):p(S,!1)})}Y(u,c)}),O(a),Y(n,a),ot()}tt(["click"]);function kn(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Et={exports:{}},te;function An(){return te||(te=1,function(n,r){n.exports=e;function e(t,c){if(!(this instanceof e))return new e(t,c);this.x=t||0,this.y=c||0}e.fromArray=function(t){return new e(t[0]||0,t[1]||0)},e.fromObject=function(t){return new e(t.x||0,t.y||0)},e.prototype.addX=function(t){return this.x+=t.x,this},e.prototype.addY=function(t){return this.y+=t.y,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},e.prototype.addScalarX=function(t){return this.x+=t,this},e.prototype.addScalarY=function(t){return this.y+=t,this},e.prototype.subtractX=function(t){return this.x-=t.x,this},e.prototype.subtractY=function(t){return this.y-=t.y,this},e.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},e.prototype.subtractScalarX=function(t){return this.x-=t,this},e.prototype.subtractScalarY=function(t){return this.y-=t,this},e.prototype.divideX=function(t){return this.x/=t.x,this},e.prototype.divideY=function(t){return this.y/=t.y,this},e.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},e.prototype.divideScalar=function(t){return t!==0?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},e.prototype.divideScalarX=function(t){return t!==0?this.x/=t:this.x=0,this},e.prototype.divideScalarY=function(t){return t!==0?this.y/=t:this.y=0,this},e.prototype.invertX=function(){return this.x*=-1,this},e.prototype.invertY=function(){return this.y*=-1,this},e.prototype.invert=function(){return this.invertX(),this.invertY(),this},e.prototype.multiplyX=function(t){return this.x*=t.x,this},e.prototype.multiplyY=function(t){return this.y*=t.y,this},e.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},e.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.prototype.multiplyScalarX=function(t){return this.x*=t,this},e.prototype.multiplyScalarY=function(t){return this.y*=t,this},e.prototype.normalize=function(){var t=this.length();return t===0?(this.x=1,this.y=0):this.divide(e(t,t)),this},e.prototype.norm=e.prototype.normalize,e.prototype.limit=function(t,c){return Math.abs(this.x)>t&&(this.x*=c),Math.abs(this.y)>t&&(this.y*=c),this},e.prototype.randomize=function(t,c){return this.randomizeX(t,c),this.randomizeY(t,c),this},e.prototype.randomizeX=function(t,c){var m=Math.min(t.x,c.x),k=Math.max(t.x,c.x);return this.x=a(m,k),this},e.prototype.randomizeY=function(t,c){var m=Math.min(t.y,c.y),k=Math.max(t.y,c.y);return this.y=a(m,k),this},e.prototype.randomizeAny=function(t,c){return Math.round(Math.random())?this.randomizeX(t,c):this.randomizeY(t,c),this},e.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.prototype.toFixed=function(t){return typeof t>"u"&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},e.prototype.mixX=function(t,c){return typeof c>"u"&&(c=.5),this.x=(1-c)*this.x+c*t.x,this},e.prototype.mixY=function(t,c){return typeof c>"u"&&(c=.5),this.y=(1-c)*this.y+c*t.y,this},e.prototype.mix=function(t,c){return this.mixX(t,c),this.mixY(t,c),this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyX=function(t){return this.x=t.x,this},e.prototype.copyY=function(t){return this.y=t.y,this},e.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},e.prototype.zero=function(){return this.x=this.y=0,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.projectOnto=function(t){var c=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=c*t.x,this.y=c*t.y,this},e.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.horizontalAngleDeg=function(){return u(this.horizontalAngle())},e.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},e.prototype.verticalAngleDeg=function(){return u(this.verticalAngle())},e.prototype.angle=e.prototype.horizontalAngle,e.prototype.angleDeg=e.prototype.horizontalAngleDeg,e.prototype.direction=e.prototype.horizontalAngle,e.prototype.rotate=function(t){var c=this.x*Math.cos(t)-this.y*Math.sin(t),m=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=c,this.y=m,this},e.prototype.rotateDeg=function(t){return t=f(t),this.rotate(t)},e.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},e.prototype.rotateToDeg=function(t){return t=f(t),this.rotateTo(t)},e.prototype.rotateBy=function(t){var c=this.angle()+t;return this.rotate(c)},e.prototype.rotateByDeg=function(t){return t=f(t),this.rotateBy(t)},e.prototype.distanceX=function(t){return this.x-t.x},e.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},e.prototype.distanceY=function(t){return this.y-t.y},e.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},e.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},e.prototype.distanceSq=function(t){var c=this.distanceX(t),m=this.distanceY(t);return c*c+m*m},e.prototype.length=function(){return Math.sqrt(this.lengthSq())},e.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},e.prototype.magnitude=e.prototype.length,e.prototype.isZero=function(){return this.x===0&&this.y===0},e.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},e.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},e.prototype.toArray=function(){return[this.x,this.y]},e.prototype.toObject=function(){return{x:this.x,y:this.y}};var o=180/Math.PI;function a(t,c){return Math.floor(Math.random()*(c-t+1)+t)}function u(t){return t*o}function f(t){return t/o}}(Et)),Et.exports}var Mn=An();const V=kn(Mn),Sn=[{id:0,name:"Addition",image:"",position:[100,100]},{id:1,name:"Subtraction",image:"",position:[300,150]},{id:2,name:"Multiplication",image:"",position:[200,300]},{id:3,name:"Division",image:"",position:[300,450]}],En=[{from:0,to:1,name:"",description:""},{from:0,to:2,name:"",description:""},{from:2,to:3,name:"",description:""}],pt={nodes:Sn,links:En};var Nn=z('<button aria-label="Close Menu"><i class="fa-solid fa-chevron-down"></i></button>'),Dn=z('<button aria-label="Open Menu"><i class="fa-solid fa-chevron-up"></i></button>'),Ln=z(`<div class="absolute bottom-1 left-1 transition duration-200"><!> <div class="flex flex-col gap-0 w-fit p-1 rounded-xl font-mono text-blue-300 bg-gray-700"><p class="text-center">------------------ Edit Log ------------------</p> <textarea class="resize-none overflow-y-scroll text-wrap outline-none" readonly="" cols="48" rows="8">
        </textarea></div></div>`);function Cn(n,r){rt(r,!0);let e=Q([]),o,a=P(0),u=Q([]),f=P(!0),t;const c=(h,v)=>{s(a)>0&&(e.splice(-s(a),s(a)),E(a,0)),u.push(h),e.push(v===void 0?h:h+`:
	`+v)},m=()=>{s(a)>u.length-1||(Vt(a),e.push("Undo: "+u.at(-s(a))))},k=()=>{s(a)<1||(e.push("Redo: "+u.at(-s(a))),Vt(a,-1))};ie(()=>{o.value+=`
`+e.at(-1),o.scrollTop=o.scrollHeight}),vt(()=>{o.value=""});var S=Ln(),p=X(S);{var _=h=>{var v=Nn();v.__click=M=>{E(f,!1),t.style.bottom="-225px"},Y(h,v)},l=h=>{var v=Dn();v.__click=M=>{E(f,!0),t.style.bottom="4px"},Y(h,v)};et(p,h=>{s(f)?h(_):h(l,!1)})}var A=N(p,2),y=N(X(A),2);return B(y,h=>o=h,()=>o),O(A),O(S),B(S,h=>t=h,()=>t),Y(n,S),ot({log:c,undo:m,redo:k})}tt(["click"]);var Tn=z('<div class="flex flex-row gap-3 w-min h-min p-3 absolute top-1 left-1 text-2xl "><button aria-label="Undo"><i class="fas fa-undo"></i></button> <button aria-label="Redo"><i class="fas fa-redo"></i></button></div>');function In(n,r){const e="border-none rounded-full w-fit h-fit bg-gray-300 p-2 pt-0.5 pb-1 text-center";var o=Tn(),a=X(o);j(a,1,e),a.__click=function(...f){var t;(t=r.undo)==null||t.apply(this,f)};var u=N(a,2);j(u,1,e),u.__click=function(...f){var t;(t=r.redo)==null||t.apply(this,f)},O(o),Y(n,o)}tt(["click"]);var On=z('<div class="flex flex-col gap-3.5 max-w-[350px] h-fit bg-neutral-950 text-white p-2.5 rounded-xl"><input type="text" placeholder="Link Title"/> <textarea rows="6" maxlength="400" placeholder="Link Description"></textarea> <div class="relative inline-block h-fit"><button>Save</button> <button>Exit</button></div></div>');function Yn(n,r){rt(r,!0);let e=P(""),o=P(""),a,u,f=!1,t=!1;vt(()=>{a.value=r.link.name,u.value=r.link.description});const c=()=>{t=!0},m="font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none";var k=On(),S=X(k);ce(S),j(S,1,m),S.__change=c,B(S,y=>a=y,()=>a);var p=N(S,2);tn(p),j(p,1,"font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none placeholder:text-neutral-400 resize-none overflow-scroll"),p.__change=c,B(p,y=>u=y,()=>u);var _=N(p,2),l=X(_);j(l,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-left"),l.__click=()=>{f=r.saveLink(r.link,s(e),s(o))};var A=N(l,2);j(A,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-right"),A.__click=()=>r.exitLink(f,t),O(_),O(k),Lt(S,()=>s(e),y=>E(e,y)),Lt(p,()=>s(o),y=>E(o,y)),Y(n,k),ot()}tt(["change","click"]);var Xn=z('<p class="pl-2"><strong> </strong> </p>'),zn=z('<p class="pl-2"><strong> </strong> </p>'),Pn=z('<button aria-label="Close Menu"><i class="fa-solid fa-chevron-up"></i></button>'),Rn=z('<button aria-label="Open Menu"><i class="fa-solid fa-chevron-down"></i></button>'),qn=z('<div class="absolute right-1 top-1 transition duration-200"><div class="bg-neutral-200 border-blue-300 border-4 p-3 pr-10 pb-6 rounded-lg"><h1 class="text-2xl">Controls</h1> <!> <br/> <h2> </h2> <!></div> <!></div>');function Un(n,r){rt(r,!0);const e=[{"Left Click":"create a new node","Left Click (on existing node)":"delete selected node"},{"Left Click (on existing node)":"edit node contents"},{"Left Click and Drag":"move node"},{"Left Click (on Node A)":"start new edge from node","Left Click (on node, once started edge)":"add new edge",Escape:"cancel new edge"},{"Left Click (on existing edge)":"edit edge contents"}],o=["Add Node","Edit Node","Move Node","Add Edge","Edit Edge"],a={"Ctrl-Z":"undo","Ctrl-Y":"redo","Ctrl-S":"save","Ctrl-O":"open"};let u=P(!0),f,t;var c=qn(),m=X(c),k=N(X(m),2);Dt(k,17,()=>Object.entries(a),Nt,(h,v)=>{var M=Wt(()=>Jt(s(v),2));let b=()=>s(M)[0],g=()=>s(M)[1];var T=Xn(),I=X(T),D=X(I,!0);O(I);var q=N(I);O(T),$(()=>{at(D,b()),at(q,` â ${g()??""}`)}),Y(h,T)});var S=N(k,4),p=X(S);O(S);var _=N(S,2);Dt(_,17,()=>Object.entries(e[r.mode]),Nt,(h,v)=>{var M=Wt(()=>Jt(s(v),2));let b=()=>s(M)[0],g=()=>s(M)[1];var T=zn(),I=X(T),D=X(I,!0);O(I);var q=N(I);O(T),$(()=>{at(D,b()),at(q,` â ${g()??""}`)}),Y(h,T)}),O(m),B(m,h=>t=h,()=>t);var l=N(m,2);{var A=h=>{var v=Pn();v.__click=M=>{E(u,!1),f.style.top=`-${t.offsetHeight}px`},Y(h,v)},y=h=>{var v=Rn();v.__click=M=>{E(u,!0),f.style.top="4px"},Y(h,v)};et(l,h=>{s(u)?h(A):h(y,!1)})}O(c),B(c,h=>f=h,()=>f),$(()=>at(p,`Mode-Specific Controls â ${o[r.mode]??""}`)),Y(n,c),ot()}tt(["click"]);var Hn=n=>n.preventDefault(),jn=z('<div id="canvas-box" class="relative inline-block overflow-hidden"><canvas tabindex="0"></canvas> <div class="absolute right-2.5 bottom-15"><!></div> <div class="absolute right-2.5 bottom-2.5"><button class="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700" aria-label="Save Graph">Save Graph</button> <button class="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700" aria-label="Load Graph">Load Graph</button> <input type="file" accept=".json"/></div> <!> <!> <!> <!></div>');function Bn(n,r){rt(r,!0);const e=i=>({nodes:i.nodes.map(d=>({...d,position:[...d.position]})),links:i.links.map(d=>({...d}))}),o=()=>{const i=A.at(-y)??s(l);if(E(l,e(i),!0),h.length!==s(l).nodes.length){for(;h.length<s(l).nodes.length;)h.push(new Image);for(;h.length>s(l).nodes.length;)h.pop()}s(l).nodes.forEach((x,w)=>{h[w].src=x.image});const d=s(l).nodes.find(x=>x.id===s(v).id);d?E(v,d,!0):E(v,s(l).nodes[0],!0)};let a,u=new V(0,0),f=1;const t=.5,c=2;let m=P(!1),k,S,p,_=new V(0,0),l=P(Q(e(pt))),A=[e(pt)],y=1,h=[],v=P(Q(pt.nodes[0])),M=P(!1),b=P(!1),g=P(Q(pt.links[0])),T=P(!1),I,D=P(!1),q=P(0),R;const W=()=>{const i=a.getContext("2d");if(i===null)throw new Error("DRAW LOOP - ctx is null");a.width=window.innerWidth,a.height=window.innerHeight,i.clearRect(0,0,a.width,a.height),i.setTransform(f,0,0,f,-u.x,-u.y),s(D)&&(i.beginPath(),i.moveTo(s(v).position[0],s(v).position[1]),i.lineTo(p.x,p.y),i.lineWidth=10,i.strokeStyle="rgba(0, 0, 0, 0.35)",i.stroke()),s(l).links.forEach(d=>{i.beginPath();const x=s(l).nodes.find(L=>L.id===d.from)??s(l).nodes[0],w=s(l).nodes.find(L=>L.id===d.to)??s(l).nodes[0];i.moveTo(x.position[0],x.position[1]),i.lineTo(w.position[0],w.position[1]),i.lineWidth=10,i.strokeStyle="black",i.stroke()}),s(l).nodes.forEach((d,x)=>{const w=V.fromArray(d.position),L=25;i.beginPath(),i.arc(w.x,w.y,20,0,Math.PI*2),i.fillStyle="black",i.fill(),i.drawImage(h[x],w.x-L/2,w.y-L/2,L,L)}),requestAnimationFrame(W)},Z=i=>{const d=a.getBoundingClientRect();return new V(i.clientX-d.left,i.clientY-d.top)},st=i=>{const d=a.getBoundingClientRect(),x=(i.clientX-d.left+u.x)/f,w=(i.clientY-d.top+u.y)/f;return new V(x,w)},lt=(i,d,x)=>{const w=d.clone().subtract(i),C=x.clone().subtract(i).dot(w)/w.lengthSq();if(C<0||C>1)return 1e6;const H=Math.abs(d.clone().subtract(i).cross(x.clone().subtract(i))),F=d.clone().subtract(i).length();return H/F},ut=i=>{if(s(b))return;const d=st(i);let x=s(l).nodes.find(C=>V.fromArray(C.position).distanceSq(d)<400);E(v,x??s(v),!0);let w=s(l).links.find(C=>{const H=s(l).nodes[C.from],F=s(l).nodes[C.to];return lt(V.fromArray(H.position),V.fromArray(F.position),d)<10});E(g,w??s(g),!0);const L=s(l).links.indexOf(s(g));if(i.button===0){if(s(q)===0){if(!x)s(l).nodes.push({id:-1,name:"",image:"",position:d.toArray()}),gt(),h.push(new Image),K(),R.log("Create node");else if(window.confirm("Delete node and its links?")){const C=x.id;s(l).nodes.splice(C,1),E(v,s(l).nodes[0],!0),h.splice(C,1);let H=[];s(l).links.forEach((F,me)=>{(F.from===C||F.to===C)&&H.push(me)});for(const F of H)s(l).links.splice(F,1);gt(),K(),R.log("Delete node",`Node ID: ${C}, ${H.length} links destroyed`)}}else if(s(q)===1){if(!x)return;E(b,!0)}else if(s(q)===2){if(!x)return;_=d.clone().subtract(V.fromArray(s(v).position)),E(M,!0)}else if(s(q)===3)if(x)if(s(D)){if(I.id===s(v).id||s(l).links.filter(C=>C.from===I.id&&C.to===s(v).id||C.from===s(v).id&&C.to===I.id).length!==0)return;s(l).links.push({from:I.id,to:s(v).id,name:"",description:""}),E(D,!1),K(),R.log("Create link",`node ${I.id} -> ${s(v).id}`)}else I=x,E(D,!0),p=d;else{if(!w)return;s(l).links.splice(L,1),K(),R.log("Delete link",`node ${I.id} -> ${s(v).id}`)}else if(s(q)===4){if(!w)return;E(T,!0)}}i.button===2&&(E(m,!0),k=Z(i),S=u.clone())},ct=i=>{if(s(b))return;const d=st(i);if(p=d,s(M)){let x=s(l).nodes.find(w=>w.id===s(v).id);if(!x)throw new Error("uhhh focusNode error, it's not in the list...");x.position=d.clone().subtract(_).toArray()}else if(s(m)){const w=Z(i).clone().subtract(k);u=S.clone().subtract(w)}},dt=i=>{s(b)||(s(M)&&(E(M,!1),K(),R.log("Set node position")),E(m,!1))},ft=i=>{i.preventDefault();const d=Z(i),x=d.clone().add(u).divideScalar(f),w=Math.sign(i.deltaY);f-=w*.125,f=Math.max(t,Math.min(c,f)),u=x.clone().multiplyScalar(f).subtract(d)},de=i=>{i.key==="Escape"&&s(D)&&E(D,!1),i.ctrlKey&&(i.key==="o"&&(i.preventDefault(),ht.click()),i.key==="s"&&(i.preventDefault(),Yt()),i.key==="z"&&It(),i.key==="y"&&Ot())},fe=(i,d,x)=>{let w=[i.name===d?"":"name",i.image===x?"":"image"],L=[];w.forEach(F=>{F!==""&&L.push(F)});const C=L.join(", ");if(C===""||!window.confirm("Save this node with new contents?"))return!1;i.name=d,i.image=x;const H=s(l).nodes.indexOf(i);return H>=0&&(h[H].src=i.image),K(),R.log("Update node contents",C),!0},he=(i,d)=>{!i&&d&&!window.confirm("Stop editing without saving?")||E(b,!1)},pe=(i,d,x)=>{let w=[i.name===d?"":"name",i.description===x?"":"description"],L=[];w.forEach(H=>{H!==""&&L.push(H)});const C=L.join(", ");return C===""||!window.confirm("Save this node with new contents?")?!1:(i.name=d,i.description=x,K(),R.log("Update node contents",C),!0)},ve=(i,d)=>{!i&&d&&!window.confirm("Stop editing without saving?")||E(T,!1)},K=()=>{y>1&&(A.splice(-y+1,y-1),y=1),A.push(e(s(l))),console.log(A),console.log(y)},It=()=>{y>A.length-1||(y++,o(),R.undo(),console.log(A),console.log(y))},Ot=()=>{y<2||(y--,o(),R.redo(),console.log(A),console.log(y))},Yt=()=>{if(window.confirm("Download new JSON?")){const i=JSON.stringify(s(l),null,4),d=new Blob([i],{type:"application/json"}),x=URL.createObjectURL(d),w=document.createElement("a");w.href=x,w.download="data.json",w.click(),URL.revokeObjectURL(x)}};let ht,Xt;const gt=()=>{const i=new Map(s(l).nodes.map((d,x)=>[d.id,x]));s(l).nodes.forEach((d,x)=>d.id=x),s(l).links.forEach(d=>{console.log(`${d.from}, ${d.to}`),d.from=i.get(d.from)??d.from,d.to=i.get(d.to)??d.to,console.log(`${d.from}, ${d.to}`)})};vt(()=>{h=s(l).nodes.map(i=>{let d=new Image;return d.src=i.image,d}),W()});var yt=jn(),G=X(yt);let zt;G.__mousemove=ct,G.__mousedown=ut,G.__mouseup=dt,G.__keydown=de,G.__contextmenu=[Hn],B(G,i=>a=i,()=>a);var xt=N(G,2),ge=X(xt);{var ye=i=>{xn(i,{get node(){return s(v)},saveNode:fe,exitNode:he})},xe=(i,d)=>{{var x=w=>{Yn(w,{get link(){return s(g)},saveLink:pe,exitLink:ve})};et(i,w=>{s(T)&&w(x)},d)}};et(ge,i=>{s(b)?i(ye):i(xe,!1)})}O(xt);var bt=N(xt,2),Pt=X(bt);Pt.__click=Yt;var Rt=N(Pt,2);Rt.__click=i=>ht.click();var mt=N(Rt,2);mt.__change=i=>{const d=i.target;if(!d.files||d.files.length===0)return;const x=d.files[0],w=new FileReader;w.onload=()=>{if(typeof w.result=="string")try{const L=JSON.parse(w.result);if(!L.nodes||!L.links)throw new Error("Invalid graph data");E(l,e(L),!0),gt(),y=1,A=[e(s(l))],o(),R.log("Load new graph data")}catch(L){alert("Failed to load graph: "+L.message)}},w.readAsText(x)},ue(mt,"",{},{display:"none"}),B(mt,i=>ht=i,()=>ht),O(bt);var qt=N(bt,2);B(Cn(qt,{}),i=>R=i,()=>R);var Ut=N(qt,2);In(Ut,{undo:It,redo:Ot});var Ht=N(Ut,2);B(wn(Ht,{modeChanged:i=>E(q,i,!0)}),i=>Xt=i,()=>Xt);var be=N(Ht,2);Un(be,{get mode(){return s(q)},set mode(i){E(q,i,!0)}}),O(yt),$(i=>zt=j(G,1,"bg-neutral-100",null,zt,i),[()=>({"cursor-grabbing":s(M)||s(m)})]),en("wheel",G,ft),Y(n,yt),ot()}tt(["mousemove","mousedown","mouseup","keydown","contextmenu","click","change"]);var Fn=z(`<style>body {
            overflow-y: hidden;
        }</style>`);function Qn(n){nn(r=>{var e=Fn();Ke.title="Graph Editor",Y(r,e)}),Bn(n,{})}export{Qn as component};
