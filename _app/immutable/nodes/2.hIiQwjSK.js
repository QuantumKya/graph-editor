import"../chunks/CWj6FrbW.js";import"../chunks/68dL1qPk.js";import{X as be,b as me,ax as Qt,s as _t,h as U,M as _e,a as we,A as a,al as ke,r as Ae,c as Me,d as qt,f as wt,j as it,Z as Se,a1 as Ee,g as $t,i as te,p as Ne,ay as kt,a4 as ee,q as Le,R as Ut,az as Dt,aA as Ht,aB as Tt,at as Ce,aC as jt,aD as De,aE as Te,N as Ie,aF as Oe,aG as Ye,aH as Xe,_ as ze,W as Pe,aI as Re,aJ as qe,aK as Ue,aL as He,aM as je,aN as Be,u as Fe,l as Ge,D as rt,au as P,am as Q,F as z,J as X,L as N,an as E,K as O,t as Y,I as ot,G as $,x as ne,m as Ve,n as We,aO as Bt,av as Ft,aP as Gt,aQ as Je}from"../chunks/DJWGDQ8C.js";import{a as Ze,l as Ke,d as tt,o as pt,r as Qe,s as at,e as $e,b as tn}from"../chunks/DoBE4cx5.js";import{b as B,i as et}from"../chunks/D6yf63is.js";import{b as re}from"../chunks/CViWVBmR.js";function Nt(n,r){return r}function en(n,r,e,o){for(var i=[],l=r.length,d=0;d<l;d++)Te(r[d].e,i,!0);var t=l>0&&i.length===0&&e!==null;if(t){var c=e.parentNode;Ie(c),c.append(e),o.clear(),J(n,r[0].prev,r[l-1].next)}Oe(i,()=>{for(var b=0;b<l;b++){var w=r[b];t||(o.delete(w.k),J(n,w.prev,w.next)),Ye(w.e,!t)}})}function Lt(n,r,e,o,i,l=null){var d=n,t={flags:r,items:new Map,first:null},c=(r&Qt)!==0;if(c){var b=n;d=U?_t(_e(b)):b.appendChild(be())}U&&we();var w=null,S=!1,p=ke(()=>{var m=e();return Pe(m)?m:m==null?[]:ee(m)});me(()=>{var m=a(p),u=m.length;if(S&&u===0)return;S=u===0;let A=!1;if(U){var y=Ae(d)===Me;y!==(u===0)&&(d=qt(),_t(d),wt(!1),A=!0)}if(U){for(var h=null,v,M=0;M<u;M++){if(it.nodeType===Se&&it.data===Ee){d=it,A=!0,wt(!1);break}var x=m[M],g=o(x,M);v=oe(it,t,h,null,x,g,M,i,r,e),t.items.set(g,v),h=v}u>0&&_t(qt())}U||nn(m,t,d,i,r,o,e),l!==null&&(u===0?w?$t(w):w=te(()=>l(d)):w!==null&&Ne(w,()=>{w=null})),A&&wt(!0),a(p)}),U&&(d=it)}function nn(n,r,e,o,i,l,d){var lt,ut,ct,dt;var t=(i&De)!==0,c=(i&(Dt|Tt))!==0,b=n.length,w=r.items,S=r.first,p=S,m,u=null,A,y=[],h=[],v,M,x,g;if(t)for(g=0;g<b;g+=1)v=n[g],M=l(v,g),x=w.get(M),x!==void 0&&((lt=x.a)==null||lt.measure(),(A??(A=new Set)).add(x));for(g=0;g<b;g+=1){if(v=n[g],M=l(v,g),x=w.get(M),x===void 0){var D=p?p.e.nodes_start:e;u=oe(D,r,u,u===null?r.first:u.next,v,M,g,o,i,d),w.set(M,u),y=[],h=[],p=u.next;continue}if(c&&rn(x,v,g,i),(x.e.f&kt)!==0&&($t(x.e),t&&((ut=x.a)==null||ut.unfix(),(A??(A=new Set)).delete(x))),x!==p){if(m!==void 0&&m.has(x)){if(y.length<h.length){var I=h[0],T;u=I.prev;var q=y[0],R=y[y.length-1];for(T=0;T<y.length;T+=1)Vt(y[T],I,e);for(T=0;T<h.length;T+=1)m.delete(h[T]);J(r,q.prev,R.next),J(r,u,q),J(r,R,I),p=I,u=R,g-=1,y=[],h=[]}else m.delete(x),Vt(x,p,e),J(r,x.prev,x.next),J(r,x,u===null?r.first:u.next),J(r,u,x),u=x;continue}for(y=[],h=[];p!==null&&p.k!==M;)(p.e.f&kt)===0&&(m??(m=new Set)).add(p),h.push(p),p=p.next;if(p===null)continue;x=p}y.push(x),u=x,p=x.next}if(p!==null||m!==void 0){for(var W=m===void 0?[]:ee(m);p!==null;)(p.e.f&kt)===0&&W.push(p),p=p.next;var Z=W.length;if(Z>0){var st=(i&Qt)!==0&&b===0?e:null;if(t){for(g=0;g<Z;g+=1)(ct=W[g].a)==null||ct.measure();for(g=0;g<Z;g+=1)(dt=W[g].a)==null||dt.fix()}en(r,W,st,w)}}t&&Le(()=>{var ft;if(A!==void 0)for(x of A)(ft=x.a)==null||ft.apply()}),Ut.first=r.first&&r.first.e,Ut.last=u&&u.e}function rn(n,r,e,o){(o&Dt)!==0&&Ht(n.v,r),(o&Tt)!==0?Ht(n.i,e):n.i=e}function oe(n,r,e,o,i,l,d,t,c,b){var w=(c&Dt)!==0,S=(c&Xe)===0,p=w?S?Ce(i,!1,!1):jt(i):i,m=(c&Tt)===0?d:jt(d),u={i:m,v:p,k:l,a:null,e:null,prev:e,next:o};try{return u.e=te(()=>t(n,p,m,b),U),u.e.prev=e&&e.e,u.e.next=o&&o.e,e===null?r.first=u:(e.next=u,e.e.next=u.e),o!==null&&(o.prev=u,o.e.prev=u.e),u}finally{}}function Vt(n,r,e){for(var o=n.next?n.next.e.nodes_start:e,i=r?r.e.nodes_start:e,l=n.e.nodes_start;l!==o;){var d=ze(l);i.before(l),l=d}}function J(n,r,e){r===null?n.first=e:(r.next=e,r.e.next=e&&e.e),e!==null&&(e.prev=r,e.e.prev=r&&r.e)}function ie(n){var r,e,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(r=0;r<i;r++)n[r]&&(e=ie(n[r]))&&(o&&(o+=" "),o+=e)}else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function on(){for(var n,r,e=0,o="",i=arguments.length;e<i;e++)(n=arguments[e])&&(r=ie(n))&&(o&&(o+=" "),o+=r);return o}function an(n){return typeof n=="object"?on(n):n??""}const Wt=[...` 	
\r\fÂ \v\uFEFF`];function sn(n,r,e){var o=n==null?"":""+n;if(r&&(o=o?o+" "+r:r),e){for(var i in e)if(e[i])o=o?o+" "+i:i;else if(o.length)for(var l=i.length,d=0;(d=o.indexOf(i,d))>=0;){var t=d+l;(d===0||Wt.includes(o[d-1]))&&(t===o.length||Wt.includes(o[t]))?o=(d===0?"":o.substring(0,d))+o.substring(t+1):d=t}}return o===""?null:o}function Jt(n,r=!1){var e=r?" !important;":";",o="";for(var i in n){var l=n[i];l!=null&&l!==""&&(o+=" "+i+": "+l+e)}return o}function ln(n,r){if(r){var e="",o,i;return Array.isArray(r)?(o=r[0],i=r[1]):o=r,o&&(e+=Jt(o)),i&&(e+=Jt(i,!0)),e=e.trim(),e===""?null:e}return String(n)}function j(n,r,e,o,i,l){var d=n.__className;if(U||d!==e||d===void 0){var t=sn(e,o,l);(!U||t!==n.getAttribute("class"))&&(t==null?n.removeAttribute("class"):n.className=t),n.__className=e}else if(l&&i!==l)for(var c in l){var b=!!l[c];(i==null||b!==!!i[c])&&n.classList.toggle(c,b)}return l}function At(n,r={},e,o){for(var i in e){var l=e[i];r[i]!==l&&(e[i]==null?n.style.removeProperty(i):n.style.setProperty(i,l,o))}}function ae(n,r,e,o){var i=n.__style;if(U||i!==r){var l=ln(r,o);(!U||l!==n.getAttribute("style"))&&(l==null?n.removeAttribute("style"):n.style.cssText=l),n.__style=r}else o&&(Array.isArray(o)?(At(n,e==null?void 0:e[0],o[0]),At(n,e==null?void 0:e[1],o[1],"important")):At(n,e,o));return o}const un=Symbol("is custom element"),cn=Symbol("is html");function se(n){if(U){var r=!1,e=()=>{if(!r){if(r=!0,n.hasAttribute("value")){var o=n.value;nt(n,"value",null),n.value=o}if(n.hasAttribute("checked")){var i=n.checked;nt(n,"checked",null),n.checked=i}}};n.__on_r=e,He(e),Ze()}}function nt(n,r,e,o){var i=dn(n);U&&(i[r]=n.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&n.nodeName==="LINK")||i[r]!==(i[r]=e)&&(r==="loading"&&(n[Re]=e),e==null?n.removeAttribute(r):typeof e!="string"&&fn(n).includes(r)?n[r]=e:n.setAttribute(r,e))}function dn(n){return n.__attributes??(n.__attributes={[un]:n.nodeName.includes("-"),[cn]:n.namespaceURI===qe})}var Zt=new Map;function fn(n){var r=Zt.get(n.nodeName);if(r)return r;Zt.set(n.nodeName,r=[]);for(var e,o=n,i=Element.prototype;i!==o;){e=je(o);for(var l in e)e[l].set&&r.push(l);o=Ue(o)}return r}function Ct(n,r,e=r){var o=Be();Ke(n,"input",i=>{var l=i?n.defaultValue:n.value;if(l=Mt(n)?St(l):l,e(l),o&&l!==(l=r())){var d=n.selectionStart,t=n.selectionEnd;n.value=l??"",t!==null&&(n.selectionStart=d,n.selectionEnd=Math.min(t,n.value.length))}}),(U&&n.defaultValue!==n.value||Fe(r)==null&&n.value)&&e(Mt(n)?St(n.value):n.value),Ge(()=>{var i=r();Mt(n)&&i===St(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function Mt(n){var r=n.type;return r==="number"||r==="range"}function St(n){return n===""?null:+n}var hn=z('<img alt="Uploaded Icon" class="rounded-lg w-[150px]"/>'),pn=z('<img alt="Uploaded Icon" class="rounded-lg w-[150px]"/>'),vn=z('<div class="flex flex-col gap-3.5 max-w-[350px] h-fit bg-neutral-950 text-white p-2.5 rounded-xl"><input type="text" placeholder="Node Title"/> <!> <button>Upload Image</button> <input type="file" accept="image/*"/> <div class="relative inline-block h-fit"><button>Save</button> <button>Exit</button></div></div>');function gn(n,r){rt(r,!0);let e=P(Q(r.node.name)),o=P(Q(r.node.image)),i,l,d=!1,t=!1;pt(()=>{l.value=r.node.name});const c=()=>{d=!0},b="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700",w="font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none";var S=vn(),p=X(S);se(p),j(p,1,w),p.__change=c,B(p,g=>l=g,()=>l);var m=N(p,2);{var u=g=>{var D=hn();$(()=>nt(D,"src",a(o))),Y(g,D)},A=g=>{var D=pn();$(()=>nt(D,"src",`${re??""}/landscape-placeholder.svg`)),Y(g,D)};et(m,g=>{a(o)!=""?g(u):g(A,!1)})}var y=N(m,2);j(y,1,b),y.__click=g=>{i.click()};var h=N(y,2);h.__change=g=>{const D=g.target;if(!D.files||D.files.length===0)return;const I=D.files[0],T=new FileReader;T.onload=()=>{typeof T.result=="string"&&E(o,T.result,!0)},T.readAsDataURL(I),c()},ae(h,"",{},{display:"none"}),B(h,g=>i=g,()=>i);var v=N(h,2),M=X(v);j(M,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-left"),M.__click=()=>{t=r.saveNode(r.node,a(e),a(o))};var x=N(M,2);j(x,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-right"),x.__click=()=>r.exitNode(t,d),O(v),O(S),Ct(p,()=>a(e),g=>E(e,g)),Y(n,S),ot()}tt(["change","click"]);var yn=z('<div class="w-[5px] bg-neutral-300 rounded-full m-3"></div>'),xn=z("<button><img/></button>"),bn=z('<div class="flex absolute rounded-xl bg-neutral-200 border-blue-300 border-2 p-[10px] pt-[5px] pb-[5px] h-fit bottom-6 left-[50%] transform -translate-[50%]"></div>');function mn(n,r){rt(r,!0);let e=P(2),o=["node_add.png","node_edit.png","node_drag.png","","link_add.png","link_edit.png"];ne(()=>{r.modeChanged(a(e))});var i=bn();Lt(i,21,()=>o,Nt,(l,d,t)=>{var c=Ve(),b=We(c);{var w=p=>{var m=yn();Y(p,m)},S=p=>{var m=xn();m.__click=()=>E(e,t-o.slice(0,t).filter(A=>A==="").length);var u=X(m);O(m),$((A,y,h)=>{j(m,1,`p-2.5 rounded-xl border-none outline-none transition duration-200 hover:bg-blue-300 ${A??""}`),nt(u,"src",`${re??""}/mode_icons/${a(d)??""}`),nt(u,"alt",y),j(u,1,h)},[()=>a(e)===t-o.slice(0,t).filter(A=>A==="").length?"bg-gray-500 mt-auto mb-auto":"mt-[10px] mb-[10px]",()=>o[t].split(".")[0],()=>an(a(e)===t-o.slice(0,t).filter(A=>A==="").length?"max-w-[40px] rounded-xl":"max-w-[30px] rounded-lg")]),Y(p,m)};et(b,p=>{a(d)===""?p(w):p(S,!1)})}Y(l,c)}),O(i),Y(n,i),ot()}tt(["click"]);function _n(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Et={exports:{}},Kt;function wn(){return Kt||(Kt=1,function(n,r){n.exports=e;function e(t,c){if(!(this instanceof e))return new e(t,c);this.x=t||0,this.y=c||0}e.fromArray=function(t){return new e(t[0]||0,t[1]||0)},e.fromObject=function(t){return new e(t.x||0,t.y||0)},e.prototype.addX=function(t){return this.x+=t.x,this},e.prototype.addY=function(t){return this.y+=t.y,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},e.prototype.addScalarX=function(t){return this.x+=t,this},e.prototype.addScalarY=function(t){return this.y+=t,this},e.prototype.subtractX=function(t){return this.x-=t.x,this},e.prototype.subtractY=function(t){return this.y-=t.y,this},e.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},e.prototype.subtractScalarX=function(t){return this.x-=t,this},e.prototype.subtractScalarY=function(t){return this.y-=t,this},e.prototype.divideX=function(t){return this.x/=t.x,this},e.prototype.divideY=function(t){return this.y/=t.y,this},e.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},e.prototype.divideScalar=function(t){return t!==0?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},e.prototype.divideScalarX=function(t){return t!==0?this.x/=t:this.x=0,this},e.prototype.divideScalarY=function(t){return t!==0?this.y/=t:this.y=0,this},e.prototype.invertX=function(){return this.x*=-1,this},e.prototype.invertY=function(){return this.y*=-1,this},e.prototype.invert=function(){return this.invertX(),this.invertY(),this},e.prototype.multiplyX=function(t){return this.x*=t.x,this},e.prototype.multiplyY=function(t){return this.y*=t.y,this},e.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},e.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.prototype.multiplyScalarX=function(t){return this.x*=t,this},e.prototype.multiplyScalarY=function(t){return this.y*=t,this},e.prototype.normalize=function(){var t=this.length();return t===0?(this.x=1,this.y=0):this.divide(e(t,t)),this},e.prototype.norm=e.prototype.normalize,e.prototype.limit=function(t,c){return Math.abs(this.x)>t&&(this.x*=c),Math.abs(this.y)>t&&(this.y*=c),this},e.prototype.randomize=function(t,c){return this.randomizeX(t,c),this.randomizeY(t,c),this},e.prototype.randomizeX=function(t,c){var b=Math.min(t.x,c.x),w=Math.max(t.x,c.x);return this.x=i(b,w),this},e.prototype.randomizeY=function(t,c){var b=Math.min(t.y,c.y),w=Math.max(t.y,c.y);return this.y=i(b,w),this},e.prototype.randomizeAny=function(t,c){return Math.round(Math.random())?this.randomizeX(t,c):this.randomizeY(t,c),this},e.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.prototype.toFixed=function(t){return typeof t>"u"&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},e.prototype.mixX=function(t,c){return typeof c>"u"&&(c=.5),this.x=(1-c)*this.x+c*t.x,this},e.prototype.mixY=function(t,c){return typeof c>"u"&&(c=.5),this.y=(1-c)*this.y+c*t.y,this},e.prototype.mix=function(t,c){return this.mixX(t,c),this.mixY(t,c),this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyX=function(t){return this.x=t.x,this},e.prototype.copyY=function(t){return this.y=t.y,this},e.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},e.prototype.zero=function(){return this.x=this.y=0,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.projectOnto=function(t){var c=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=c*t.x,this.y=c*t.y,this},e.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.horizontalAngleDeg=function(){return l(this.horizontalAngle())},e.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},e.prototype.verticalAngleDeg=function(){return l(this.verticalAngle())},e.prototype.angle=e.prototype.horizontalAngle,e.prototype.angleDeg=e.prototype.horizontalAngleDeg,e.prototype.direction=e.prototype.horizontalAngle,e.prototype.rotate=function(t){var c=this.x*Math.cos(t)-this.y*Math.sin(t),b=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=c,this.y=b,this},e.prototype.rotateDeg=function(t){return t=d(t),this.rotate(t)},e.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},e.prototype.rotateToDeg=function(t){return t=d(t),this.rotateTo(t)},e.prototype.rotateBy=function(t){var c=this.angle()+t;return this.rotate(c)},e.prototype.rotateByDeg=function(t){return t=d(t),this.rotateBy(t)},e.prototype.distanceX=function(t){return this.x-t.x},e.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},e.prototype.distanceY=function(t){return this.y-t.y},e.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},e.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},e.prototype.distanceSq=function(t){var c=this.distanceX(t),b=this.distanceY(t);return c*c+b*b},e.prototype.length=function(){return Math.sqrt(this.lengthSq())},e.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},e.prototype.magnitude=e.prototype.length,e.prototype.isZero=function(){return this.x===0&&this.y===0},e.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},e.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},e.prototype.toArray=function(){return[this.x,this.y]},e.prototype.toObject=function(){return{x:this.x,y:this.y}};var o=180/Math.PI;function i(t,c){return Math.floor(Math.random()*(c-t+1)+t)}function l(t){return t*o}function d(t){return t/o}}(Et)),Et.exports}var kn=wn();const V=_n(kn),An=[{id:0,name:"Addition",image:"",position:[100,100]},{id:1,name:"Subtraction",image:"",position:[300,150]},{id:2,name:"Multiplication",image:"",position:[200,300]},{id:3,name:"Division",image:"",position:[300,450]}],Mn=[{from:0,to:1,name:"",description:""},{from:0,to:2,name:"",description:""},{from:2,to:3,name:"",description:""}],ht={nodes:An,links:Mn};var Sn=z('<button aria-label="Close Menu"><i class="fa-solid fa-chevron-down"></i></button>'),En=z('<button aria-label="Open Menu"><i class="fa-solid fa-chevron-up"></i></button>'),Nn=z(`<div class="absolute bottom-1 left-1 transition duration-200"><!> <div class="flex flex-col gap-0 w-fit p-1 rounded-xl font-mono text-blue-300 bg-gray-700"><p class="text-center">------------------ Edit Log ------------------</p> <textarea class="resize-none overflow-y-scroll text-wrap outline-none" readonly="" cols="48" rows="8">
        </textarea></div></div>`);function Ln(n,r){rt(r,!0);let e=Q([]),o,i=P(0),l=Q([]),d=P(!0),t;const c=(h,v)=>{a(i)>0&&(e.splice(-a(i),a(i)),E(i,0)),l.push(h),e.push(v===void 0?h:h+`:
	`+v)},b=()=>{a(i)>l.length-1||(Bt(i),e.push("Undo: "+l.at(-a(i))))},w=()=>{a(i)<1||(e.push("Redo: "+l.at(-a(i))),Bt(i,-1))};ne(()=>{o.value+=`
`+e.at(-1),o.scrollTop=o.scrollHeight}),pt(()=>{o.value=""});var S=Nn(),p=X(S);{var m=h=>{var v=Sn();v.__click=M=>{E(d,!1),t.style.bottom="-225px"},Y(h,v)},u=h=>{var v=En();v.__click=M=>{E(d,!0),t.style.bottom="4px"},Y(h,v)};et(p,h=>{a(d)?h(m):h(u,!1)})}var A=N(p,2),y=N(X(A),2);return B(y,h=>o=h,()=>o),O(A),O(S),B(S,h=>t=h,()=>t),Y(n,S),ot({log:c,undo:b,redo:w})}tt(["click"]);var Cn=z('<div class="flex flex-row gap-3 w-min h-min p-3 absolute top-1 left-1 text-2xl "><button aria-label="Undo"><i class="fas fa-undo"></i></button> <button aria-label="Redo"><i class="fas fa-redo"></i></button></div>');function Dn(n,r){const e="border-none rounded-full w-fit h-fit bg-gray-300 p-2 pt-0.5 pb-1 text-center";var o=Cn(),i=X(o);j(i,1,e),i.__click=function(...d){var t;(t=r.undo)==null||t.apply(this,d)};var l=N(i,2);j(l,1,e),l.__click=function(...d){var t;(t=r.redo)==null||t.apply(this,d)},O(o),Y(n,o)}tt(["click"]);var Tn=z('<div class="flex flex-col gap-3.5 max-w-[350px] h-fit bg-neutral-950 text-white p-2.5 rounded-xl"><input type="text" placeholder="Link Title"/> <textarea rows="6" maxlength="400" placeholder="Link Description"></textarea> <div class="relative inline-block h-fit"><button>Save</button> <button>Exit</button></div></div>');function In(n,r){rt(r,!0);let e=P(""),o=P(""),i,l,d=!1,t=!1;pt(()=>{i.value=r.link.name,l.value=r.link.description});const c=()=>{t=!0},b="font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none";var w=Tn(),S=X(w);se(S),j(S,1,b),S.__change=c,B(S,y=>i=y,()=>i);var p=N(S,2);Qe(p),j(p,1,"font-mono text-lg bg-neutral-800 text-white rounded-xl p-2 pl-3 transition duration-300 focus:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none placeholder:text-neutral-400 resize-none overflow-scroll"),p.__change=c,B(p,y=>l=y,()=>l);var m=N(p,2),u=X(m);j(u,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-left"),u.__click=()=>{d=r.saveLink(r.link,a(e),a(o))};var A=N(u,2);j(A,1,"bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700 float-right"),A.__click=()=>r.exitLink(d,t),O(m),O(w),Ct(S,()=>a(e),y=>E(e,y)),Ct(p,()=>a(o),y=>E(o,y)),Y(n,w),ot()}tt(["change","click"]);var On=z('<p class="pl-2"><strong> </strong> </p>'),Yn=z('<p class="pl-2"><strong> </strong> </p>'),Xn=z('<button aria-label="Close Menu"><i class="fa-solid fa-chevron-up"></i></button>'),zn=z('<button aria-label="Open Menu"><i class="fa-solid fa-chevron-down"></i></button>'),Pn=z('<div class="absolute right-1 top-1 transition duration-200"><div class="bg-neutral-200 border-blue-300 border-4 p-3 pr-10 pb-6 rounded-lg"><h1 class="text-2xl">Controls</h1> <!> <br/> <h2> </h2> <!></div> <!></div>');function Rn(n,r){rt(r,!0);const e=[{"Left Click":"create a new node","Left Click (on existing node)":"delete selected node"},{"Left Click (on existing node)":"edit node contents"},{"Left Click and Drag":"move node"},{"Left Click (on Node A)":"start new edge from node","Left Click (on node, once started edge)":"add new edge",Escape:"cancel new edge"},{"Left Click (on existing edge)":"edit edge contents"}],o=["Add Node","Edit Node","Move Node","Add Edge","Edit Edge"],i={"Ctrl-Z":"undo","Ctrl-Y":"redo","Ctrl-S":"save","Ctrl-O":"open"};let l=P(!0),d,t;var c=Pn(),b=X(c),w=N(X(b),2);Lt(w,17,()=>Object.entries(i),Nt,(h,v)=>{var M=Ft(()=>Gt(a(v),2));let x=()=>a(M)[0],g=()=>a(M)[1];var D=On(),I=X(D),T=X(I,!0);O(I);var q=N(I);O(D),$(()=>{at(T,x()),at(q,` â ${g()??""}`)}),Y(h,D)});var S=N(w,4),p=X(S);O(S);var m=N(S,2);Lt(m,17,()=>Object.entries(e[r.mode]),Nt,(h,v)=>{var M=Ft(()=>Gt(a(v),2));let x=()=>a(M)[0],g=()=>a(M)[1];var D=Yn(),I=X(D),T=X(I,!0);O(I);var q=N(I);O(D),$(()=>{at(T,x()),at(q,` â ${g()??""}`)}),Y(h,D)}),O(b),B(b,h=>t=h,()=>t);var u=N(b,2);{var A=h=>{var v=Xn();v.__click=M=>{E(l,!1),d.style.top=`-${t.offsetHeight}px`},Y(h,v)},y=h=>{var v=zn();v.__click=M=>{E(l,!0),d.style.top="4px"},Y(h,v)};et(u,h=>{a(l)?h(A):h(y,!1)})}O(c),B(c,h=>d=h,()=>d),$(()=>at(p,`Mode-Specific Controls â ${o[r.mode]??""}`)),Y(n,c),ot()}tt(["click"]);const qn=(n,r)=>{n.key==="Escape"&&a(r)&&E(r,!1)},Un=(n,r)=>{if(window.confirm("Download new JSON?")){const e=JSON.stringify(a(r),null,4),o=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(o),l=document.createElement("a");l.href=i,l.download="data.json",l.click(),URL.revokeObjectURL(i)}};var Hn=n=>n.preventDefault(),jn=z('<div id="canvas-box" class="relative inline-block overflow-hidden"><canvas tabindex="0"></canvas> <div class="absolute right-2.5 bottom-15"><!></div> <div class="absolute right-2.5 bottom-2.5"><button class="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700" aria-label="Save Graph">Save Graph</button> <button class="bg-neutral-800 text-white border-blue-500 text-center rounded-xl border-2 w-fit p-2 pt-1 transition duration-200 hover:bg-gray-700" aria-label="Load Graph">Load Graph</button> <input type="file" accept=".json"/></div> <!> <!> <!> <!></div>');function Bn(n,r){rt(r,!0);const e=s=>({nodes:s.nodes.map(f=>({...f,position:[...f.position]})),links:s.links.map(f=>({...f}))}),o=()=>{const s=A.at(-y)??a(u);if(E(u,e(s),!0),h.length!==a(u).nodes.length){for(;h.length<a(u).nodes.length;)h.push(new Image);for(;h.length>a(u).nodes.length;)h.pop()}a(u).nodes.forEach((_,k)=>{h[k].src=_.image});const f=a(u).nodes.find(_=>_.id===a(v).id);f?E(v,f,!0):E(v,a(u).nodes[0],!0)};let i,l=new V(0,0),d=1;const t=.5,c=2;let b=P(!1),w,S,p,m=new V(0,0),u=P(Q(e(ht))),A=[e(ht)],y=1,h=[],v=P(Q(ht.nodes[0])),M=P(!1),x=P(!1),g=P(Q(ht.links[0])),D=P(!1),I,T=P(!1),q=P(0),R;const W=()=>{const s=i.getContext("2d");if(s===null)throw new Error("DRAW LOOP - ctx is null");i.width=window.innerWidth,i.height=window.innerHeight,s.clearRect(0,0,i.width,i.height),s.setTransform(d,0,0,d,-l.x,-l.y),a(T)&&(s.beginPath(),s.moveTo(a(v).position[0],a(v).position[1]),s.lineTo(p.x,p.y),s.lineWidth=10,s.strokeStyle="rgba(0, 0, 0, 0.35)",s.stroke()),a(u).links.forEach(f=>{s.beginPath();const _=a(u).nodes.find(L=>L.id===f.from)??a(u).nodes[0],k=a(u).nodes.find(L=>L.id===f.to)??a(u).nodes[0];s.moveTo(_.position[0],_.position[1]),s.lineTo(k.position[0],k.position[1]),s.lineWidth=10,s.strokeStyle="black",s.stroke()}),a(u).nodes.forEach((f,_)=>{const k=V.fromArray(f.position),L=25;s.beginPath(),s.arc(k.x,k.y,20,0,Math.PI*2),s.fillStyle="black",s.fill(),s.drawImage(h[_],k.x-L/2,k.y-L/2,L,L)}),requestAnimationFrame(W)},Z=s=>{const f=i.getBoundingClientRect();return new V(s.clientX-f.left,s.clientY-f.top)},st=s=>{const f=i.getBoundingClientRect(),_=(s.clientX-f.left+l.x)/d,k=(s.clientY-f.top+l.y)/d;return new V(_,k)},lt=(s,f,_)=>{const k=f.clone().subtract(s),C=_.clone().subtract(s).dot(k)/k.lengthSq();if(C<0||C>1)return 1e6;const H=Math.abs(f.clone().subtract(s).cross(_.clone().subtract(s))),F=f.clone().subtract(s).length();return H/F},ut=s=>{if(a(x))return;const f=st(s);let _=a(u).nodes.find(C=>V.fromArray(C.position).distanceSq(f)<400);E(v,_??a(v),!0);let k=a(u).links.find(C=>{const H=a(u).nodes[C.from],F=a(u).nodes[C.to];return lt(V.fromArray(H.position),V.fromArray(F.position),f)<10});E(g,k??a(g),!0);const L=a(u).links.indexOf(a(g));if(s.button===0){if(a(q)===0){if(!_)a(u).nodes.push({id:-1,name:"",image:"",position:f.toArray()}),gt(),h.push(new Image),K(),R.log("Create node");else if(window.confirm("Delete node and its links?")){const C=_.id;a(u).nodes.splice(C,1),E(v,a(u).nodes[0],!0),h.splice(C,1);let H=[];a(u).links.forEach((F,xe)=>{(F.from===C||F.to===C)&&H.push(xe)});for(const F of H)a(u).links.splice(F,1);gt(),K(),R.log("Delete node",`Node ID: ${C}, ${H.length} links destroyed`)}}else if(a(q)===1){if(!_)return;E(x,!0)}else if(a(q)===2){if(!_)return;m=f.clone().subtract(V.fromArray(a(v).position)),E(M,!0)}else if(a(q)===3)if(_)if(a(T)){if(I.id===a(v).id||a(u).links.filter(C=>C.from===I.id&&C.to===a(v).id||C.from===a(v).id&&C.to===I.id).length!==0)return;a(u).links.push({from:I.id,to:a(v).id,name:"",description:""}),E(T,!1),K(),R.log("Create link",`node ${I.id} -> ${a(v).id}`)}else I=_,E(T,!0),p=f;else{if(!k)return;a(u).links.splice(L,1),K(),R.log("Delete link",`node ${I.id} -> ${a(v).id}`)}else if(a(q)===4){if(!k)return;E(D,!0)}}s.button===2&&(E(b,!0),w=Z(s),S=l.clone())},ct=s=>{if(a(x))return;const f=st(s);if(p=f,a(M)){let _=a(u).nodes.find(k=>k.id===a(v).id);if(!_)throw new Error("uhhh focusNode error, it's not in the list...");_.position=f.clone().subtract(m).toArray()}else if(a(b)){const k=Z(s).clone().subtract(w);l=S.clone().subtract(k)}},dt=s=>{a(x)||(a(M)&&(E(M,!1),K(),R.log("Set node position")),E(b,!1))},ft=s=>{s.preventDefault();const f=Z(s),_=f.clone().add(l).divideScalar(d),k=Math.sign(s.deltaY);d-=k*.125,d=Math.max(t,Math.min(c,d)),l=_.clone().multiplyScalar(d).subtract(f)},le=(s,f,_)=>{let k=[s.name===f?"":"name",s.image===_?"":"image"],L=[];k.forEach(F=>{F!==""&&L.push(F)});const C=L.join(", ");if(C===""||!window.confirm("Save this node with new contents?"))return!1;s.name=f,s.image=_;const H=a(u).nodes.indexOf(s);return H>=0&&(h[H].src=s.image),K(),R.log("Update node contents",C),!0},ue=(s,f)=>{!s&&f&&!window.confirm("Stop editing without saving?")||E(x,!1)},ce=(s,f,_)=>{let k=[s.name===f?"":"name",s.description===_?"":"description"],L=[];k.forEach(H=>{H!==""&&L.push(H)});const C=L.join(", ");return C===""||!window.confirm("Save this node with new contents?")?!1:(s.name=f,s.description=_,K(),R.log("Update node contents",C),!0)},de=(s,f)=>{!s&&f&&!window.confirm("Stop editing without saving?")||E(D,!1)},K=()=>{y>1&&(A.splice(-y+1,y-1),y=1),A.push(e(a(u))),console.log(A),console.log(y)},fe=()=>{y>A.length-1||(y++,o(),R.undo(),console.log(A),console.log(y))},he=()=>{y<2||(y--,o(),R.redo(),console.log(A),console.log(y))};let vt,It;const gt=()=>{const s=new Map(a(u).nodes.map((f,_)=>[f.id,_]));a(u).nodes.forEach((f,_)=>f.id=_),a(u).links.forEach(f=>{console.log(`${f.from}, ${f.to}`),f.from=s.get(f.from)??f.from,f.to=s.get(f.to)??f.to,console.log(`${f.from}, ${f.to}`)})};pt(()=>{h=a(u).nodes.map(s=>{let f=new Image;return f.src=s.image,f}),W()});var yt=jn(),G=X(yt);let Ot;G.__mousemove=ct,G.__mousedown=ut,G.__mouseup=dt,G.__keydown=[qn,T],G.__contextmenu=[Hn],B(G,s=>i=s,()=>i);var xt=N(G,2),pe=X(xt);{var ve=s=>{gn(s,{get node(){return a(v)},saveNode:le,exitNode:ue})},ge=(s,f)=>{{var _=k=>{In(k,{get link(){return a(g)},saveLink:ce,exitLink:de})};et(s,k=>{a(D)&&k(_)},f)}};et(pe,s=>{a(x)?s(ve):s(ge,!1)})}O(xt);var bt=N(xt,2),Yt=X(bt);Yt.__click=[Un,u];var Xt=N(Yt,2);Xt.__click=s=>vt.click();var mt=N(Xt,2);mt.__change=s=>{const f=s.target;if(!f.files||f.files.length===0)return;const _=f.files[0],k=new FileReader;k.onload=()=>{if(typeof k.result=="string")try{const L=JSON.parse(k.result);if(!L.nodes||!L.links)throw new Error("Invalid graph data");E(u,e(L),!0),gt(),y=1,A=[e(a(u))],o(),R.log("Load new graph data")}catch(L){alert("Failed to load graph: "+L.message)}},k.readAsText(_)},ae(mt,"",{},{display:"none"}),B(mt,s=>vt=s,()=>vt),O(bt);var zt=N(bt,2);B(Ln(zt,{}),s=>R=s,()=>R);var Pt=N(zt,2);Dn(Pt,{undo:fe,redo:he});var Rt=N(Pt,2);B(mn(Rt,{modeChanged:s=>E(q,s,!0)}),s=>It=s,()=>It);var ye=N(Rt,2);Rn(ye,{get mode(){return a(q)},set mode(s){E(q,s,!0)}}),O(yt),$(s=>Ot=j(G,1,"bg-neutral-100",null,Ot,s),[()=>({"cursor-grabbing":a(M)||a(b)})]),$e("wheel",G,ft),Y(n,yt),ot()}tt(["mousemove","mousedown","mouseup","keydown","contextmenu","click","change"]);var Fn=z(`<style>body {
            overflow-y: hidden;
        }</style>`);function Qn(n){tn(r=>{var e=Fn();Je.title="Graph Editor",Y(r,e)}),Bn(n,{})}export{Qn as component};
