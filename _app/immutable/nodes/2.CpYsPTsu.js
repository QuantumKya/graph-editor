import"../chunks/CWj6FrbW.js";import{i as nt}from"../chunks/_Bemseac.js";import{d as st,o as tt}from"../chunks/CSf8_nqO.js";import{h as Y,V as at,a0 as ut,N as H,O as K,Q as ct,R as ht,av as lt,aw as pt,ax as ft,ay as dt,az as yt,aA as vt,u as gt,o as xt,D as et,as as q,ak as O,F as T,J as C,L as M,al as x,z as u,K as F,a as k,I as it,G as mt,ar as N,aB as _}from"../chunks/DJjvfAQa.js";import{b as I,i as rt}from"../chunks/OtDB2zW1.js";function _t(i){Y&&at(i)!==null&&ut(i)}let W=!1;function ot(){W||(W=!0,document.addEventListener("reset",i=>{Promise.resolve().then(()=>{var r;if(!i.defaultPrevented)for(const e of i.target.elements)(r=e.__on_r)==null||r.call(e)})},{capture:!0}))}function bt(i){var r=ct,e=ht;H(null),K(null);try{return i()}finally{H(r),K(e)}}function Mt(i,r,e,s=e){i.addEventListener(r,()=>bt(e));const n=i.__on_r;n?i.__on_r=()=>{n(),s(!0)}:i.__on_r=()=>s(!0),ot()}function J(i,r=!1){var e=r?" !important;":";",s="";for(var n in i){var c=i[n];c!=null&&c!==""&&(s+=" "+n+": "+c+e)}return s}function At(i,r){if(r){var e="",s,n;return Array.isArray(r)?(s=r[0],n=r[1]):s=r,s&&(e+=J(s)),n&&(e+=J(n,!0)),e=e.trim(),e===""?null:e}return String(i)}function L(i,r={},e,s){for(var n in e){var c=e[n];r[n]!==c&&(e[n]==null?i.style.removeProperty(n):i.style.setProperty(n,c,s))}}function St(i,r,e,s){var n=i.__style;if(Y||n!==r){var c=At(r,s);(!Y||c!==i.getAttribute("style"))&&(c==null?i.removeAttribute("style"):i.style.cssText=c),i.__style=r}else s&&(Array.isArray(s)?(L(i,e==null?void 0:e[0],s[0]),L(i,e==null?void 0:e[1],s[1],"important")):L(i,e,s));return s}const wt=Symbol("is custom element"),Yt=Symbol("is html");function Xt(i){if(Y){var r=!1,e=()=>{if(!r){if(r=!0,i.hasAttribute("value")){var s=i.value;R(i,"value",null),i.value=s}if(i.hasAttribute("checked")){var n=i.checked;R(i,"checked",null),i.checked=n}}};i.__on_r=e,lt(e),ot()}}function R(i,r,e,s){var n=zt(i);Y&&(n[r]=i.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&i.nodeName==="LINK")||n[r]!==(n[r]=e)&&(r==="loading"&&(i[dt]=e),e==null?i.removeAttribute(r):typeof e!="string"&&Et(i).includes(r)?i[r]=e:i.setAttribute(r,e))}function zt(i){return i.__attributes??(i.__attributes={[wt]:i.nodeName.includes("-"),[Yt]:i.namespaceURI===pt})}var Q=new Map;function Et(i){var r=Q.get(i.nodeName);if(r)return r;Q.set(i.nodeName,r=[]);for(var e,s=i,n=Element.prototype;n!==s;){e=yt(s);for(var c in e)e[c].set&&r.push(c);s=ft(s)}return r}function Z(i,r,e=r){var s=vt();Mt(i,"input",n=>{var c=n?i.defaultValue:i.value;if(c=U(i)?V(c):c,e(c),s&&c!==(c=r())){var y=i.selectionStart,t=i.selectionEnd;i.value=c??"",t!==null&&(i.selectionStart=y,i.selectionEnd=Math.min(t,i.value.length))}}),(Y&&i.defaultValue!==i.value||gt(r)==null&&i.value)&&e(U(i)?V(i.value):i.value),xt(()=>{var n=r();U(i)&&n===V(i.value)||i.type==="date"&&!n&&!i.value||n!==i.value&&(i.value=n??"")})}function U(i){var r=i.type;return r==="number"||r==="range"}function V(i){return i===""?null:+i}const Dt=[{id:0,name:"Addition",description:"",image:"/landscape-placeholder.svg",position:[100,100]},{id:1,name:"Subtraction",description:"",image:"/landscape-placeholder.svg",position:[300,150]},{id:2,name:"Multiplication",description:"",image:"/landscape-placeholder.svg",position:[200,300]},{id:3,name:"Division",description:"",image:"/landscape-placeholder.svg",position:[300,450]}],Nt=[{from:0,to:1},{from:0,to:2},{from:2,to:3}],G={nodes:Dt,links:Nt};var kt=T('<img alt="Uploaded Icon" id="display-image" class="svelte-gj9au2"/>'),It=T('<img src="/landscape-placeholder.svg" alt="Uploaded Icon" id="display-image" class="svelte-gj9au2"/>'),Tt=T('<div id="panel" class="svelte-gj9au2"><input type="text" class="text-input svelte-gj9au2" placeholder="Node Title"/> <button id="image" class="svelte-gj9au2">Upload Image</button> <input type="file" accept="image/*"/> <!> <textarea rows="8" maxlength="400" class="text-input svelte-gj9au2" id="desc" placeholder="Node Description"></textarea> <button id="save" class="svelte-gj9au2">Save</button> <button id="exit" class="svelte-gj9au2">Exit</button></div>');function jt(i,r){et(r,!0);const s=G.nodes[r.node_id];let n=q(O(s.name)),c=q(O(s.description)),y=q(O(s.image)),t,o,d,p=!1;tt(()=>{o.value=s.name,d.value=s.description});var g=Tt(),A=C(g);Xt(A),I(A,l=>o=l,()=>o);var X=M(A,2);X.__click=l=>{t.click()};var S=M(X,2);S.__change=l=>{const a=l.target;if(!a.files||a.files.length===0)return;const h=a.files[0],f=new FileReader;f.onload=()=>{typeof f.result=="string"&&x(y,f.result,!0)},f.readAsDataURL(h)},St(S,"",{},{display:"none"}),I(S,l=>t=l,()=>t);var D=M(S,2);{var j=l=>{var a=kt();mt(()=>R(a,"src",u(y))),k(l,a)},z=l=>{var a=It();k(l,a)};rt(D,l=>{u(y)!=""?l(j):l(z,!1)})}var m=M(D,2);_t(m),I(m,l=>d=l,()=>d);var E=M(m,2);E.__click=()=>{r.saveNode(r.node_id,u(n),u(c),u(y)),p=!0};var P=M(E,2);P.__click=()=>r.exitNode(p),F(g),Z(A,()=>u(n),l=>x(n,l)),Z(m,()=>u(c),l=>x(c,l)),k(i,g),it()}st(["click","change"]);function Pt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var B={exports:{}},$;function qt(){return $||($=1,function(i,r){i.exports=e;function e(t,o){if(!(this instanceof e))return new e(t,o);this.x=t||0,this.y=o||0}e.fromArray=function(t){return new e(t[0]||0,t[1]||0)},e.fromObject=function(t){return new e(t.x||0,t.y||0)},e.prototype.addX=function(t){return this.x+=t.x,this},e.prototype.addY=function(t){return this.y+=t.y,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},e.prototype.addScalarX=function(t){return this.x+=t,this},e.prototype.addScalarY=function(t){return this.y+=t,this},e.prototype.subtractX=function(t){return this.x-=t.x,this},e.prototype.subtractY=function(t){return this.y-=t.y,this},e.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},e.prototype.subtractScalarX=function(t){return this.x-=t,this},e.prototype.subtractScalarY=function(t){return this.y-=t,this},e.prototype.divideX=function(t){return this.x/=t.x,this},e.prototype.divideY=function(t){return this.y/=t.y,this},e.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},e.prototype.divideScalar=function(t){return t!==0?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},e.prototype.divideScalarX=function(t){return t!==0?this.x/=t:this.x=0,this},e.prototype.divideScalarY=function(t){return t!==0?this.y/=t:this.y=0,this},e.prototype.invertX=function(){return this.x*=-1,this},e.prototype.invertY=function(){return this.y*=-1,this},e.prototype.invert=function(){return this.invertX(),this.invertY(),this},e.prototype.multiplyX=function(t){return this.x*=t.x,this},e.prototype.multiplyY=function(t){return this.y*=t.y,this},e.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},e.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.prototype.multiplyScalarX=function(t){return this.x*=t,this},e.prototype.multiplyScalarY=function(t){return this.y*=t,this},e.prototype.normalize=function(){var t=this.length();return t===0?(this.x=1,this.y=0):this.divide(e(t,t)),this},e.prototype.norm=e.prototype.normalize,e.prototype.limit=function(t,o){return Math.abs(this.x)>t&&(this.x*=o),Math.abs(this.y)>t&&(this.y*=o),this},e.prototype.randomize=function(t,o){return this.randomizeX(t,o),this.randomizeY(t,o),this},e.prototype.randomizeX=function(t,o){var d=Math.min(t.x,o.x),p=Math.max(t.x,o.x);return this.x=n(d,p),this},e.prototype.randomizeY=function(t,o){var d=Math.min(t.y,o.y),p=Math.max(t.y,o.y);return this.y=n(d,p),this},e.prototype.randomizeAny=function(t,o){return Math.round(Math.random())?this.randomizeX(t,o):this.randomizeY(t,o),this},e.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.prototype.toFixed=function(t){return typeof t>"u"&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},e.prototype.mixX=function(t,o){return typeof o>"u"&&(o=.5),this.x=(1-o)*this.x+o*t.x,this},e.prototype.mixY=function(t,o){return typeof o>"u"&&(o=.5),this.y=(1-o)*this.y+o*t.y,this},e.prototype.mix=function(t,o){return this.mixX(t,o),this.mixY(t,o),this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyX=function(t){return this.x=t.x,this},e.prototype.copyY=function(t){return this.y=t.y,this},e.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},e.prototype.zero=function(){return this.x=this.y=0,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.projectOnto=function(t){var o=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=o*t.x,this.y=o*t.y,this},e.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.horizontalAngleDeg=function(){return c(this.horizontalAngle())},e.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},e.prototype.verticalAngleDeg=function(){return c(this.verticalAngle())},e.prototype.angle=e.prototype.horizontalAngle,e.prototype.angleDeg=e.prototype.horizontalAngleDeg,e.prototype.direction=e.prototype.horizontalAngle,e.prototype.rotate=function(t){var o=this.x*Math.cos(t)-this.y*Math.sin(t),d=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=o,this.y=d,this},e.prototype.rotateDeg=function(t){return t=y(t),this.rotate(t)},e.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},e.prototype.rotateToDeg=function(t){return t=y(t),this.rotateTo(t)},e.prototype.rotateBy=function(t){var o=this.angle()+t;return this.rotate(o)},e.prototype.rotateByDeg=function(t){return t=y(t),this.rotateBy(t)},e.prototype.distanceX=function(t){return this.x-t.x},e.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},e.prototype.distanceY=function(t){return this.y-t.y},e.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},e.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},e.prototype.distanceSq=function(t){var o=this.distanceX(t),d=this.distanceY(t);return o*o+d*d},e.prototype.length=function(){return Math.sqrt(this.lengthSq())},e.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},e.prototype.magnitude=e.prototype.length,e.prototype.isZero=function(){return this.x===0&&this.y===0},e.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},e.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},e.prototype.toArray=function(){return[this.x,this.y]},e.prototype.toObject=function(){return{x:this.x,y:this.y}};var s=180/Math.PI;function n(t,o){return Math.floor(Math.random()*(o-t+1)+t)}function c(t){return t*s}function y(t){return t/s}}(B)),B.exports}var Ot=qt();const b=Pt(Ot);var Lt=T('<div id="canvas-box" class="svelte-7gvlvt"><canvas width="1700" height="800" class="svelte-7gvlvt"></canvas> <div id="edit-panel" class="svelte-7gvlvt"><!></div></div>');function Ut(i,r){et(r,!1);let e=N(),s=new b(0,0),n=1,c=!1,y=new b(0,0),t=new b(0,0),o=N(G.nodes),d=G.links,p=N(),g=N(!1);const A=a=>{a.clearRect(0,0,u(e).width,u(e).height),d.forEach(h=>{a.beginPath();const f=u(o)[h.from],v=u(o)[h.to];a.moveTo((f.position[0]-s.x)/n,(f.position[1]-s.y)/n),a.lineTo((v.position[0]-s.x)/n,(v.position[1]-s.y)/n),a.lineWidth=7.5,a.strokeStyle="black",a.stroke()}),u(o).forEach(h=>{const f=new Image;f.src=h.image;const v=b.fromArray(h.position).subtract(s).divideScalar(n),w=25/n;a.beginPath(),a.arc(v.x,v.y,20/n,0,Math.PI*2),a.fillStyle="black",a.fill(),a.drawImage(f,v.x-w/2,v.y-w/2,w,w)})},X=a=>{const h=u(e).getBoundingClientRect(),f=(a.clientX-h.left+s.x)/n,v=(a.clientY-h.top+s.y)/n;return new b(f,v)},S=a=>{if(u(g))return;const h=X(a);x(p,u(o).find(f=>b.fromArray(f.position).distance(h)<20)??null),a.button===0?u(p)?t=h.clone().subtract(b.fromArray(u(p).position)):(c=!0,y=h):a.button===2&&u(p)&&x(g,!0)},D=a=>{if(u(g))return;const h=X(a);if(u(p))_(p,u(p).position=h.clone().subtract(t).toArray());else if(c){const f=h.clone().subtract(y);s.subtract(f)}},j=a=>{u(g)||(x(p,null),c=!1)};tt(()=>{setInterval(A,1e3/30,u(e).getContext("2d")),_(e,u(e).onmousedown=S),_(e,u(e).onmousemove=D),_(e,u(e).onmouseup=j),u(e).addEventListener("contextmenu",a=>a.preventDefault())}),nt();var z=Lt(),m=C(z);I(m,a=>x(e,a),()=>u(e));var E=M(m,2),P=C(E);{var l=a=>{jt(a,{get node_id(){return u(p).id},saveNode:(h,f,v,w)=>{window.confirm("Save this node with new contents?")&&(_(o,u(o)[h].name=f),_(o,u(o)[h].description=v),_(o,u(o)[h].image=w))},exitNode:h=>{!h&&!window.confirm("Stop editing without saving?")||(x(g,!1),x(p,null))}})};rt(P,a=>{u(g)&&u(p)&&a(l)})}F(E),F(z),k(i,z),it()}function Gt(i){Ut(i,{})}export{Gt as component};
